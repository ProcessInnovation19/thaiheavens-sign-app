import{_ as d,C as h,c as E,o as e,ah as p,b as l,j as n,w as i,a,G as r,ai as o}from"./chunks/framework.D--hi4lz.js";const b=JSON.parse('{"title":"API Flow Documentation","description":"","frontmatter":{},"headers":[],"relativePath":"api_flow.md","filePath":"api_flow.md"}'),u={name:"api_flow.md"};function k(A,s,c,g,F,S){const t=h("Mermaid");return e(),E("div",null,[s[14]||(s[14]=p('<h1 id="api-flow-documentation" tabindex="-1">API Flow Documentation <a class="header-anchor" href="#api-flow-documentation" aria-label="Permalink to &quot;API Flow Documentation&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>This document describes all API interactions in ThaiHeavensSignApp using Mermaid diagrams.</p><h2 id="api-request-response-flow" tabindex="-1">API Request/Response Flow <a class="header-anchor" href="#api-request-response-flow" aria-label="Permalink to &quot;API Request/Response Flow&quot;">​</a></h2>',4)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-12",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20A%5BFrontend%5D%20--%3E%7CHTTP%20Request%7C%20B%5BExpress%20Router%5D%0A%20%20%20%20B%20--%3E%20C%7BRoute%20Handler%7D%0A%20%20%20%20C%20--%3E%20D%5BService%20Layer%5D%0A%20%20%20%20D%20--%3E%20E%5BFile%20System%5D%0A%20%20%20%20E%20--%3E%20D%0A%20%20%20%20D%20--%3E%20C%0A%20%20%20%20C%20--%3E%7CJSON%20Response%7C%20A%0A"})]),fallback:i(()=>[...s[0]||(s[0]=[a(" Loading... ",-1)])]),_:1})),s[15]||(s[15]=p('<h3 id="request-flow" tabindex="-1">Request Flow <a class="header-anchor" href="#request-flow" aria-label="Permalink to &quot;Request Flow&quot;">​</a></h3><ol><li>Frontend makes HTTP request</li><li>Express router matches route</li><li>Route handler processes request</li><li>Service layer performs business logic</li><li>File system operations occur</li><li>Response flows back through layers</li></ol><hr><h2 id="upload-pdf-api-flow" tabindex="-1">Upload PDF API Flow <a class="header-anchor" href="#upload-pdf-api-flow" aria-label="Permalink to &quot;Upload PDF API Flow&quot;">​</a></h2>',4)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-52",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20M%20as%20Multer%0A%20%20%20%20participant%20U%20as%20Upload%20Route%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3EU%3A%20POST%20%2Fapi%2Fupload-pdf%3Cbr%2F%3E(multipart%2Fform-data)%0A%20%20%20%20U-%3E%3EM%3A%20Handle%20file%20upload%0A%20%20%20%20M-%3E%3EFS%3A%20Save%20to%20uploads%2F%20(temp)%0A%20%20%20%20FS--%3E%3EM%3A%20Temp%20file%20path%0A%20%20%20%20M--%3E%3EU%3A%20req.file%0A%20%20%20%20U-%3E%3ES%3A%20Generate%20pdfId%20(UUID)%0A%20%20%20%20U-%3E%3EFS%3A%20Move%20file%20to%20storage%2Foriginal%2F%0A%20%20%20%20FS--%3E%3EU%3A%20Success%0A%20%20%20%20U--%3E%3EF%3A%20%7BpdfId%2C%20filePath%7D%0A"})]),fallback:i(()=>[...s[1]||(s[1]=[a(" Loading... ",-1)])]),_:1})),s[16]||(s[16]=p(`<h3 id="upload-endpoint-details" tabindex="-1">Upload Endpoint Details <a class="header-anchor" href="#upload-endpoint-details" aria-label="Permalink to &quot;Upload Endpoint Details&quot;">​</a></h3><p><strong>Endpoint:</strong> <code>POST /api/upload-pdf</code></p><p><strong>Request:</strong></p><ul><li>Content-Type: <code>multipart/form-data</code></li><li>Body: <code>file</code> (PDF file)</li></ul><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid-string&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;filePath&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/absolute/path/to/file.pdf&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Error Responses:</strong></p><ul><li><code>400 Bad Request</code>: No file uploaded</li><li><code>500 Internal Server Error</code>: File system error</li></ul><hr><h2 id="create-session-api-flow" tabindex="-1">Create Session API Flow <a class="header-anchor" href="#create-session-api-flow" aria-label="Permalink to &quot;Create Session API Flow&quot;">​</a></h2>`,10)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-97",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20SR%20as%20Session%20Route%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3ESR%3A%20POST%20%2Fapi%2Fcreate-session%3Cbr%2F%3E%7BpdfId%2C%20guestName%2C%20guestEmail%2C%3Cbr%2F%3Epage%2C%20x%2C%20y%2C%20width%2C%20height%7D%0A%20%20%20%20SR-%3E%3ESR%3A%20Validate%20input%0A%20%20%20%20SR-%3E%3ESR%3A%20Generate%20sessionId%20(UUID)%0A%20%20%20%20SR-%3E%3ESR%3A%20Generate%20token%20(UUID%20no%20dashes)%0A%20%20%20%20SR-%3E%3ES%3A%20Create%20SigningSession%20object%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Existing%20sessions%0A%20%20%20%20S-%3E%3ES%3A%20Add%20new%20session%0A%20%20%20%20S-%3E%3EFS%3A%20Write%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20S--%3E%3ESR%3A%20Session%20created%0A%20%20%20%20SR-%3E%3ESR%3A%20Build%20publicUrl%0A%20%20%20%20SR--%3E%3EF%3A%20%7BsessionId%2C%20token%2C%20publicUrl%7D%0A"})]),fallback:i(()=>[...s[2]||(s[2]=[a(" Loading... ",-1)])]),_:1})),s[17]||(s[17]=p(`<h3 id="create-session-endpoint-details" tabindex="-1">Create Session Endpoint Details <a class="header-anchor" href="#create-session-endpoint-details" aria-label="Permalink to &quot;Create Session Endpoint Details&quot;">​</a></h3><p><strong>Endpoint:</strong> <code>POST /api/create-session</code></p><p><strong>Request Body:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestEmail&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;john@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;page&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sessionId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tokenstringnodashes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;publicUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/sign/tokenstringnodashes&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Error Responses:</strong></p><ul><li><code>400 Bad Request</code>: Missing required fields</li><li><code>500 Internal Server Error</code>: Storage error</li></ul><hr><h2 id="get-session-api-flow" tabindex="-1">Get Session API Flow <a class="header-anchor" href="#get-session-api-flow" aria-label="Permalink to &quot;Get Session API Flow&quot;">​</a></h2>`,10)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-131",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20SR%20as%20Session%20Route%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3ESR%3A%20GET%20%2Fapi%2Fsession%2F%3Atoken%0A%20%20%20%20SR-%3E%3ES%3A%20getSessionByToken(token)%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20All%20sessions%0A%20%20%20%20S-%3E%3ES%3A%20Find%20session%20by%20token%0A%20%20%20%20alt%20Session%20Found%0A%20%20%20%20%20%20%20%20S-%3E%3ES%3A%20Build%20public%20info%20(no%20internal%20paths)%0A%20%20%20%20%20%20%20%20S--%3E%3ESR%3A%20SessionPublicInfo%0A%20%20%20%20%20%20%20%20SR--%3E%3EF%3A%20%7Bid%2C%20token%2C%20guestName%2C%20status%2C%3Cbr%2F%3EpdfViewUrl%2C%20page%7D%0A%20%20%20%20else%20Session%20Not%20Found%0A%20%20%20%20%20%20%20%20S--%3E%3ESR%3A%20undefined%0A%20%20%20%20%20%20%20%20SR--%3E%3EF%3A%20404%20Not%20Found%0A%20%20%20%20end%0A"})]),fallback:i(()=>[...s[3]||(s[3]=[a(" Loading... ",-1)])]),_:1})),s[18]||(s[18]=p(`<h3 id="get-session-endpoint-details" tabindex="-1">Get Session Endpoint Details <a class="header-anchor" href="#get-session-endpoint-details" aria-label="Permalink to &quot;Get Session Endpoint Details&quot;">​</a></h3><p><strong>Endpoint:</strong> <code>GET /api/session/:token</code></p><p><strong>Response (Success):</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tokenstring&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestEmail&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;john@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pending&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfViewUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/pdf/uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;page&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Response (Error):</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Session not found&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Status: <code>404 Not Found</code></p><hr><h2 id="sign-session-api-flow" tabindex="-1">Sign Session API Flow <a class="header-anchor" href="#sign-session-api-flow" aria-label="Permalink to &quot;Sign Session API Flow&quot;">​</a></h2>`,9)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-153",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20SR%20as%20Session%20Route%0A%20%20%20%20participant%20PS%20as%20PDF%20Service%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3ESR%3A%20POST%20%2Fapi%2Fsession%2F%3Atoken%2Fsign%3Cbr%2F%3E%7BsignatureImageBase64%7D%0A%20%20%20%20SR-%3E%3ES%3A%20getSessionByToken(token)%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Session%20data%0A%20%20%20%20S--%3E%3ESR%3A%20Session%20object%0A%20%20%20%20SR-%3E%3ESR%3A%20Extract%20base64%20data%0A%20%20%20%20SR-%3E%3EPS%3A%20applySignatureToPdf(session%2C%20base64)%0A%20%20%20%20PS-%3E%3EFS%3A%20Read%20original%20PDF%0A%20%20%20%20FS--%3E%3EPS%3A%20PDF%20bytes%0A%20%20%20%20PS-%3E%3EPS%3A%20Load%20PDF%20with%20pdf-lib%0A%20%20%20%20PS-%3E%3EPS%3A%20Convert%20base64%20to%20PNG%0A%20%20%20%20PS-%3E%3EPS%3A%20Embed%20PNG%20in%20PDF%0A%20%20%20%20Note%20over%20PS%3A%20Coordinate%20conversion%3A%3Cbr%2F%3EpdfY%20%3D%20pageHeight%20-%20y%20-%20height%0A%20%20%20%20PS-%3E%3EFS%3A%20Save%20signed%20PDF%0A%20%20%20%20FS--%3E%3EPS%3A%20Success%0A%20%20%20%20PS-%3E%3ES%3A%20Update%20session%20(signedPdfPath%2C%20status)%0A%20%20%20%20S-%3E%3EFS%3A%20Update%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20PS--%3E%3ESR%3A%20Signed%20PDF%20path%0A%20%20%20%20SR-%3E%3ESR%3A%20Build%20preview%20URL%0A%20%20%20%20SR--%3E%3EF%3A%20%7BsignedPdfUrl%2C%20sessionId%7D%0A"})]),fallback:i(()=>[...s[4]||(s[4]=[a(" Loading... ",-1)])]),_:1})),s[19]||(s[19]=p(`<h3 id="sign-session-endpoint-details" tabindex="-1">Sign Session Endpoint Details <a class="header-anchor" href="#sign-session-endpoint-details" aria-label="Permalink to &quot;Sign Session Endpoint Details&quot;">​</a></h3><p><strong>Endpoint:</strong> <code>POST /api/session/:token/sign</code></p><p><strong>Request Body:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;signatureImageBase64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;data:image/png;base64,iVBORw0KG...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;signedPdfUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/admin/session/:id/preview-signed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sessionId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Error Responses:</strong></p><ul><li><code>404 Not Found</code>: Session not found</li><li><code>500 Internal Server Error</code>: PDF processing error</li></ul><hr><h2 id="confirm-session-api-flow" tabindex="-1">Confirm Session API Flow <a class="header-anchor" href="#confirm-session-api-flow" aria-label="Permalink to &quot;Confirm Session API Flow&quot;">​</a></h2>`,10)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-187",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20SR%20as%20Session%20Route%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3ESR%3A%20POST%20%2Fapi%2Fsession%2F%3Atoken%2Fconfirm%0A%20%20%20%20SR-%3E%3ES%3A%20getSessionByToken(token)%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Session%20data%0A%20%20%20%20S--%3E%3ESR%3A%20Session%20object%0A%20%20%20%20SR-%3E%3ES%3A%20Update%20session%20status%20to%20%22completed%22%0A%20%20%20%20S-%3E%3EFS%3A%20Update%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20S--%3E%3ESR%3A%20Success%0A%20%20%20%20SR--%3E%3EF%3A%20%7Bsuccess%3A%20true%7D%0A"})]),fallback:i(()=>[...s[5]||(s[5]=[a(" Loading... ",-1)])]),_:1})),s[20]||(s[20]=p(`<h3 id="confirm-session-endpoint-details" tabindex="-1">Confirm Session Endpoint Details <a class="header-anchor" href="#confirm-session-endpoint-details" aria-label="Permalink to &quot;Confirm Session Endpoint Details&quot;">​</a></h3><p><strong>Endpoint:</strong> <code>POST /api/session/:token/confirm</code></p><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Error Responses:</strong></p><ul><li><code>404 Not Found</code>: Session not found</li><li><code>500 Internal Server Error</code>: Storage error</li></ul><hr><h2 id="admin-api-flows" tabindex="-1">Admin API Flows <a class="header-anchor" href="#admin-api-flows" aria-label="Permalink to &quot;Admin API Flows&quot;">​</a></h2><h3 id="get-all-sessions" tabindex="-1">Get All Sessions <a class="header-anchor" href="#get-all-sessions" aria-label="Permalink to &quot;Get All Sessions&quot;">​</a></h3>`,9)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-220",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20AR%20as%20Admin%20Route%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3EAR%3A%20GET%20%2Fapi%2Fadmin%2Fsessions%0A%20%20%20%20AR-%3E%3ES%3A%20getSessions()%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Sessions%20array%0A%20%20%20%20S--%3E%3EAR%3A%20All%20sessions%20(full%20objects)%0A%20%20%20%20AR--%3E%3EF%3A%20%5Bsessions%20array%5D%0A"})]),fallback:i(()=>[...s[6]||(s[6]=[a(" Loading... ",-1)])]),_:1})),s[21]||(s[21]=n("h3",{id:"download-signed-pdf",tabindex:"-1"},[a("Download Signed PDF "),n("a",{class:"header-anchor",href:"#download-signed-pdf","aria-label":'Permalink to "Download Signed PDF"'},"​")],-1)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-224",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20AR%20as%20Admin%20Route%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3EAR%3A%20GET%20%2Fapi%2Fadmin%2Fsession%2F%3Aid%2Fdownload-signed%0A%20%20%20%20AR-%3E%3ES%3A%20getSessionById(id)%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Session%20data%0A%20%20%20%20S--%3E%3EAR%3A%20Session%20object%0A%20%20%20%20AR-%3E%3EAR%3A%20Check%20status%20%3D%3D%3D%20%22completed%22%0A%20%20%20%20AR-%3E%3EFS%3A%20Read%20signed%20PDF%20file%0A%20%20%20%20FS--%3E%3EAR%3A%20PDF%20file%20stream%0A%20%20%20%20AR--%3E%3EF%3A%20PDF%20download%3Cbr%2F%3E(Content-Disposition%3A%20attachment)%0A"})]),fallback:i(()=>[...s[7]||(s[7]=[a(" Loading... ",-1)])]),_:1})),s[22]||(s[22]=n("h3",{id:"delete-session",tabindex:"-1"},[a("Delete Session "),n("a",{class:"header-anchor",href:"#delete-session","aria-label":'Permalink to "Delete Session"'},"​")],-1)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-228",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20AR%20as%20Admin%20Route%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3EAR%3A%20DELETE%20%2Fapi%2Fadmin%2Fsession%2F%3Aid%0A%20%20%20%20AR-%3E%3ES%3A%20deleteSession(id)%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Sessions%20array%0A%20%20%20%20S-%3E%3ES%3A%20Find%20session%0A%20%20%20%20S-%3E%3EFS%3A%20Delete%20signed%20PDF%20(if%20exists)%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20S-%3E%3EFS%3A%20Remove%20from%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20S--%3E%3EAR%3A%20Success%0A%20%20%20%20AR--%3E%3EF%3A%20%7Bsuccess%3A%20true%7D%0A"})]),fallback:i(()=>[...s[8]||(s[8]=[a(" Loading... ",-1)])]),_:1})),s[23]||(s[23]=n("hr",null,null,-1)),s[24]||(s[24]=n("h2",{id:"pdf-streaming-api-flow",tabindex:"-1"},[a("PDF Streaming API Flow "),n("a",{class:"header-anchor",href:"#pdf-streaming-api-flow","aria-label":'Permalink to "PDF Streaming API Flow"'},"​")],-1)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-233",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20PR%20as%20PDF%20Route%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3EPR%3A%20GET%20%2Fapi%2Fpdf%2F%3ApdfId%0A%20%20%20%20PR-%3E%3EFS%3A%20Read%20PDF%20from%20storage%2Foriginal%2F%0A%20%20%20%20alt%20File%20Exists%0A%20%20%20%20%20%20%20%20FS--%3E%3EPR%3A%20PDF%20file%20stream%0A%20%20%20%20%20%20%20%20PR-%3E%3EPR%3A%20Set%20Content-Type%3A%20application%2Fpdf%0A%20%20%20%20%20%20%20%20PR--%3E%3EF%3A%20PDF%20stream%0A%20%20%20%20else%20File%20Not%20Found%0A%20%20%20%20%20%20%20%20FS--%3E%3EPR%3A%20Error%0A%20%20%20%20%20%20%20%20PR--%3E%3EF%3A%20404%20Not%20Found%0A%20%20%20%20end%0A"})]),fallback:i(()=>[...s[9]||(s[9]=[a(" Loading... ",-1)])]),_:1})),s[25]||(s[25]=p('<h3 id="pdf-streaming-details" tabindex="-1">PDF Streaming Details <a class="header-anchor" href="#pdf-streaming-details" aria-label="Permalink to &quot;PDF Streaming Details&quot;">​</a></h3><p><strong>Endpoint:</strong> <code>GET /api/pdf/:pdfId</code></p><p><strong>Response:</strong></p><ul><li>Content-Type: <code>application/pdf</code></li><li>PDF file stream</li></ul><p><strong>Error Response:</strong></p><ul><li><code>404 Not Found</code>: PDF file not found</li></ul><hr><h2 id="calibration-api-flow" tabindex="-1">Calibration API Flow <a class="header-anchor" href="#calibration-api-flow" aria-label="Permalink to &quot;Calibration API Flow&quot;">​</a></h2>',8)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-269",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20CR%20as%20Calibrate%20Route%0A%20%20%20%20participant%20PS%20as%20PDF%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3ECR%3A%20POST%20%2Fapi%2Fcalibrate%2Ftest-pdf%3Cbr%2F%3E%7BpdfId%2C%20page%2C%20x%2C%20y%2C%20width%2C%20height%2C%3Cbr%2F%3EsignatureImageBase64%3F%7D%0A%20%20%20%20CR-%3E%3EFS%3A%20Read%20original%20PDF%0A%20%20%20%20FS--%3E%3ECR%3A%20PDF%20bytes%0A%20%20%20%20CR-%3E%3EPS%3A%20Load%20PDF%20with%20pdf-lib%0A%20%20%20%20alt%20Signature%20Provided%0A%20%20%20%20%20%20%20%20CR-%3E%3EPS%3A%20Embed%20signature%20at%20coordinates%0A%20%20%20%20else%20No%20Signature%0A%20%20%20%20%20%20%20%20CR-%3E%3EPS%3A%20Draw%20red%20rectangle%20at%20coordinates%0A%20%20%20%20end%0A%20%20%20%20PS-%3E%3EPS%3A%20Generate%20modified%20PDF%0A%20%20%20%20PS--%3E%3ECR%3A%20PDF%20bytes%20(Uint8Array)%0A%20%20%20%20CR-%3E%3ECR%3A%20Convert%20to%20Buffer%0A%20%20%20%20CR-%3E%3ECR%3A%20Set%20Content-Type%3A%20application%2Fpdf%0A%20%20%20%20CR--%3E%3EF%3A%20PDF%20stream%20(inline)%0A"})]),fallback:i(()=>[...s[10]||(s[10]=[a(" Loading... ",-1)])]),_:1})),s[26]||(s[26]=p(`<h3 id="calibration-endpoint-details" tabindex="-1">Calibration Endpoint Details <a class="header-anchor" href="#calibration-endpoint-details" aria-label="Permalink to &quot;Calibration Endpoint Details&quot;">​</a></h3><p><strong>Endpoint:</strong> <code>POST /api/calibrate/test-pdf</code></p><p><strong>Request Body:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;page&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;signatureImageBase64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;optional-base64-string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Response:</strong></p><ul><li>Content-Type: <code>application/pdf</code></li><li>PDF file stream with test box or signature</li></ul><hr><h2 id="api-error-handling-flow" tabindex="-1">API Error Handling Flow <a class="header-anchor" href="#api-error-handling-flow" aria-label="Permalink to &quot;API Error Handling Flow&quot;">​</a></h2>`,8)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-299",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20A%5BAPI%20Request%5D%20--%3E%20B%7BValidate%20Input%7D%0A%20%20%20%20B%20--%3E%7CInvalid%7C%20C%5B400%20Bad%20Request%5D%0A%20%20%20%20B%20--%3E%7CValid%7C%20D%7BResource%20Exists%3F%7D%0A%20%20%20%20D%20--%3E%7CNo%7C%20E%5B404%20Not%20Found%5D%0A%20%20%20%20D%20--%3E%7CYes%7C%20F%7BProcess%20Request%7D%0A%20%20%20%20F%20--%3E%7CError%7C%20G%5B500%20Server%20Error%5D%0A%20%20%20%20F%20--%3E%7CSuccess%7C%20H%5B200%20OK%5D%0A%20%20%20%20%0A%20%20%20%20C%20--%3E%20I%5BJSON%20Error%20Response%5D%0A%20%20%20%20E%20--%3E%20I%0A%20%20%20%20G%20--%3E%20I%0A%20%20%20%20H%20--%3E%20J%5BJSON%20Success%20Response%5D%0A"})]),fallback:i(()=>[...s[11]||(s[11]=[a(" Loading... ",-1)])]),_:1})),s[27]||(s[27]=p(`<h3 id="error-response-format" tabindex="-1">Error Response Format <a class="header-anchor" href="#error-response-format" aria-label="Permalink to &quot;Error Response Format&quot;">​</a></h3><p>All errors return JSON:</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Error message&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Status Codes:</strong></p><ul><li><code>200 OK</code>: Success</li><li><code>400 Bad Request</code>: Invalid input</li><li><code>404 Not Found</code>: Resource not found</li><li><code>500 Internal Server Error</code>: Server error</li></ul><hr><h2 id="api-authentication-flow-future" tabindex="-1">API Authentication Flow (Future) <a class="header-anchor" href="#api-authentication-flow-future" aria-label="Permalink to &quot;API Authentication Flow (Future)&quot;">​</a></h2>`,7)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-336",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20A%20as%20Auth%20Middleware%0A%20%20%20%20participant%20R%20as%20Route%20Handler%0A%20%20%20%20participant%20S%20as%20Service%0A%20%20%20%20%0A%20%20%20%20F-%3E%3ER%3A%20Request%20with%20token%0A%20%20%20%20R-%3E%3EA%3A%20Check%20authentication%0A%20%20%20%20alt%20Valid%20Token%0A%20%20%20%20%20%20%20%20A-%3E%3EA%3A%20Verify%20JWT%0A%20%20%20%20%20%20%20%20A--%3E%3ER%3A%20Authenticated%0A%20%20%20%20%20%20%20%20R-%3E%3ES%3A%20Process%20request%0A%20%20%20%20%20%20%20%20S--%3E%3ER%3A%20Result%0A%20%20%20%20%20%20%20%20R--%3E%3EF%3A%20Success%20response%0A%20%20%20%20else%20Invalid%20Token%0A%20%20%20%20%20%20%20%20A--%3E%3ER%3A%20Unauthorized%0A%20%20%20%20%20%20%20%20R--%3E%3EF%3A%20401%20Unauthorized%0A%20%20%20%20end%0A"})]),fallback:i(()=>[...s[12]||(s[12]=[a(" Loading... ",-1)])]),_:1})),s[28]||(s[28]=n("h3",{id:"future-authentication",tabindex:"-1"},[a("Future Authentication "),n("a",{class:"header-anchor",href:"#future-authentication","aria-label":'Permalink to "Future Authentication"'},"​")],-1)),s[29]||(s[29]=n("p",null,[n("strong",null,"Current State:"),a(" No authentication "),n("strong",null,"Future:"),a(" Add JWT-based authentication for admin routes")],-1)),s[30]||(s[30]=n("hr",null,null,-1)),s[31]||(s[31]=n("h2",{id:"api-rate-limiting-flow-future",tabindex:"-1"},[a("API Rate Limiting Flow (Future) "),n("a",{class:"header-anchor",href:"#api-rate-limiting-flow-future","aria-label":'Permalink to "API Rate Limiting Flow (Future)"'},"​")],-1)),(e(),l(o,null,{default:i(()=>[r(t,{id:"mermaid-347",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20RL%20as%20Rate%20Limiter%0A%20%20%20%20participant%20R%20as%20Route%20Handler%0A%20%20%20%20%0A%20%20%20%20F-%3E%3ERL%3A%20Request%0A%20%20%20%20RL-%3E%3ERL%3A%20Check%20rate%20limit%0A%20%20%20%20alt%20Within%20Limit%0A%20%20%20%20%20%20%20%20RL-%3E%3ER%3A%20Allow%20request%0A%20%20%20%20%20%20%20%20R--%3E%3EF%3A%20Response%0A%20%20%20%20else%20Exceeded%20Limit%0A%20%20%20%20%20%20%20%20RL--%3E%3EF%3A%20429%20Too%20Many%20Requests%0A%20%20%20%20end%0A"})]),fallback:i(()=>[...s[13]||(s[13]=[a(" Loading... ",-1)])]),_:1})),s[32]||(s[32]=p('<h3 id="future-rate-limiting" tabindex="-1">Future Rate Limiting <a class="header-anchor" href="#future-rate-limiting" aria-label="Permalink to &quot;Future Rate Limiting&quot;">​</a></h3><p><strong>Current State:</strong> No rate limiting <strong>Future:</strong> Add rate limiting to prevent abuse</p><hr><h2 id="notes-for-developers" tabindex="-1">Notes for Developers <a class="header-anchor" href="#notes-for-developers" aria-label="Permalink to &quot;Notes for Developers&quot;">​</a></h2><h3 id="api-design-principles" tabindex="-1">API Design Principles <a class="header-anchor" href="#api-design-principles" aria-label="Permalink to &quot;API Design Principles&quot;">​</a></h3><ol><li><strong>RESTful:</strong> Use standard HTTP methods</li><li><strong>JSON:</strong> All responses in JSON format</li><li><strong>Error Handling:</strong> Consistent error format</li><li><strong>Status Codes:</strong> Use appropriate HTTP status codes</li><li><strong>Validation:</strong> Validate all inputs</li></ol><h3 id="api-security" tabindex="-1">API Security <a class="header-anchor" href="#api-security" aria-label="Permalink to &quot;API Security&quot;">​</a></h3><p><strong>Current:</strong></p><ul><li>No authentication</li><li>CORS enabled for all origins</li><li>No rate limiting</li></ul><p><strong>Production Requirements:</strong></p><ul><li>Add authentication</li><li>Restrict CORS</li><li>Implement rate limiting</li><li>Validate file uploads</li><li>Sanitize inputs</li></ul><hr><h2 id="notes-for-ai-regeneration" tabindex="-1">Notes for AI Regeneration <a class="header-anchor" href="#notes-for-ai-regeneration" aria-label="Permalink to &quot;Notes for AI Regeneration&quot;">​</a></h2><h3 id="required-api-patterns" tabindex="-1">Required API Patterns <a class="header-anchor" href="#required-api-patterns" aria-label="Permalink to &quot;Required API Patterns&quot;">​</a></h3><ol><li><strong>Upload:</strong> Multipart form data handling</li><li><strong>Session Management:</strong> CRUD operations</li><li><strong>PDF Operations:</strong> File streaming</li><li><strong>Error Handling:</strong> Consistent error responses</li></ol><h3 id="api-contract" tabindex="-1">API Contract <a class="header-anchor" href="#api-contract" aria-label="Permalink to &quot;API Contract&quot;">​</a></h3><p><strong>Always:</strong></p><ul><li>Return JSON for errors</li><li>Use appropriate status codes</li><li>Validate input data</li><li>Handle file operations safely</li><li>Never expose internal paths</li></ul><p><strong>Never:</strong></p><ul><li>Return internal file paths to frontend</li><li>Skip input validation</li><li>Expose sensitive data</li><li>Allow direct file system access</li></ul><hr><h2 id="api-endpoint-summary" tabindex="-1">API Endpoint Summary <a class="header-anchor" href="#api-endpoint-summary" aria-label="Permalink to &quot;API Endpoint Summary&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Method</th><th>Endpoint</th><th>Purpose</th><th>Auth Required</th></tr></thead><tbody><tr><td>POST</td><td><code>/api/upload-pdf</code></td><td>Upload PDF</td><td>No</td></tr><tr><td>POST</td><td><code>/api/create-session</code></td><td>Create session</td><td>No</td></tr><tr><td>GET</td><td><code>/api/session/:token</code></td><td>Get session</td><td>No</td></tr><tr><td>POST</td><td><code>/api/session/:token/sign</code></td><td>Apply signature</td><td>No</td></tr><tr><td>POST</td><td><code>/api/session/:token/confirm</code></td><td>Confirm signature</td><td>No</td></tr><tr><td>GET</td><td><code>/api/admin/sessions</code></td><td>List sessions</td><td>No*</td></tr><tr><td>GET</td><td><code>/api/admin/session/:id/download-signed</code></td><td>Download PDF</td><td>No*</td></tr><tr><td>GET</td><td><code>/api/admin/session/:id/preview-signed</code></td><td>Preview PDF</td><td>No*</td></tr><tr><td>DELETE</td><td><code>/api/admin/session/:id</code></td><td>Delete session</td><td>No*</td></tr><tr><td>GET</td><td><code>/api/pdf/:pdfId</code></td><td>Stream PDF</td><td>No</td></tr><tr><td>POST</td><td><code>/api/calibrate/test-pdf</code></td><td>Test PDF</td><td>No</td></tr></tbody></table><p>*Currently no auth, but should be added in production</p><hr><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>This document provides complete API flow documentation. All endpoints follow RESTful principles and return consistent JSON responses. Error handling is implemented at each layer, and file operations are performed safely.</p>',27))])}const C=d(u,[["render",k]]);export{b as __pageData,C as default};
