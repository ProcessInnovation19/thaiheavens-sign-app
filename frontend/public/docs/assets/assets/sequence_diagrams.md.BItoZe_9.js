import{_ as d,C as E,c as P,o as i,ah as r,b as t,j as A,w as a,a as n,G as o,ai as l}from"./chunks/framework.D--hi4lz.js";const h=JSON.parse('{"title":"Sequence Diagrams","description":"","frontmatter":{},"headers":[],"relativePath":"sequence_diagrams.md","filePath":"sequence_diagrams.md"}'),p={name:"sequence_diagrams.md"};function F(c,e,g,S,u,m){const s=E("Mermaid");return i(),P("div",null,[e[10]||(e[10]=r('<h1 id="sequence-diagrams" tabindex="-1">Sequence Diagrams <a class="header-anchor" href="#sequence-diagrams" aria-label="Permalink to &quot;Sequence Diagrams&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>This document contains sequence diagrams for all major flows in ThaiHeavensSignApp.</p><h2 id="admin-flow-create-signing-session" tabindex="-1">Admin Flow: Create Signing Session <a class="header-anchor" href="#admin-flow-create-signing-session" aria-label="Permalink to &quot;Admin Flow: Create Signing Session&quot;">​</a></h2>',4)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-12",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20A%20as%20Admin%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20A-%3E%3EF%3A%20Upload%20PDF%0A%20%20%20%20F-%3E%3EAPI%3A%20POST%20%2Fapi%2Fupload-pdf%0A%20%20%20%20API-%3E%3EFS%3A%20Save%20PDF%20to%20original%2F%0A%20%20%20%20FS--%3E%3EAPI%3A%20pdfId%0A%20%20%20%20API--%3E%3EF%3A%20%7BpdfId%7D%0A%20%20%20%20F-%3E%3EF%3A%20Display%20PDF%0A%20%20%20%20%0A%20%20%20%20A-%3E%3EF%3A%20Click%20to%20position%20signature%0A%20%20%20%20F-%3E%3EF%3A%20Calculate%20coordinates%0A%20%20%20%20F-%3E%3EF%3A%20Show%20signature%20box%0A%20%20%20%20%0A%20%20%20%20A-%3E%3EF%3A%20Enter%20guest%20details%0A%20%20%20%20A-%3E%3EF%3A%20Click%20%22Create%20Session%22%0A%20%20%20%20F-%3E%3EAPI%3A%20POST%20%2Fapi%2Fcreate-session%0A%20%20%20%20API-%3E%3ES%3A%20Generate%20session%0A%20%20%20%20S-%3E%3EFS%3A%20Save%20to%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20S--%3E%3EAPI%3A%20%7BsessionId%2C%20token%2C%20publicUrl%7D%0A%20%20%20%20API--%3E%3EF%3A%20Session%20created%0A%20%20%20%20F-%3E%3EF%3A%20Display%20signing%20link%0A%20%20%20%20A-%3E%3EA%3A%20Copy%20and%20send%20link%0A"})]),fallback:a(()=>[...e[0]||(e[0]=[n(" Loading... ",-1)])]),_:1})),e[11]||(e[11]=r('<h3 id="flow-explanation" tabindex="-1">Flow Explanation <a class="header-anchor" href="#flow-explanation" aria-label="Permalink to &quot;Flow Explanation&quot;">​</a></h3><ol><li>Admin uploads PDF file</li><li>Backend stores PDF and returns ID</li><li>Admin positions signature box on PDF</li><li>Admin enters guest information</li><li>Backend creates session and generates token</li><li>Frontend displays signing link</li></ol><hr><h2 id="guest-flow-sign-contract" tabindex="-1">Guest Flow: Sign Contract <a class="header-anchor" href="#guest-flow-sign-contract" aria-label="Permalink to &quot;Guest Flow: Sign Contract&quot;">​</a></h2>',4)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-52",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20G%20as%20Guest%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20PS%20as%20PDF%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20G-%3E%3EF%3A%20Open%20signing%20link%0A%20%20%20%20F-%3E%3EAPI%3A%20GET%20%2Fapi%2Fsession%2F%3Atoken%0A%20%20%20%20API-%3E%3ES%3A%20Get%20session%20by%20token%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Session%20data%0A%20%20%20%20S--%3E%3EAPI%3A%20Session%20info%0A%20%20%20%20API--%3E%3EF%3A%20%7Bsession%20info%2C%20pdfViewUrl%7D%0A%20%20%20%20F-%3E%3EAPI%3A%20GET%20%2Fapi%2Fpdf%2F%3ApdfId%0A%20%20%20%20API-%3E%3EFS%3A%20Read%20PDF%20from%20original%2F%0A%20%20%20%20FS--%3E%3EAPI%3A%20PDF%20file%0A%20%20%20%20API--%3E%3EF%3A%20PDF%20stream%0A%20%20%20%20F-%3E%3EF%3A%20Display%20PDF%0A%20%20%20%20%0A%20%20%20%20G-%3E%3EF%3A%20Draw%20signature%0A%20%20%20%20F-%3E%3EF%3A%20Export%20as%20PNG%20base64%0A%20%20%20%20G-%3E%3EF%3A%20Click%20%22Apply%20Signature%22%0A%20%20%20%20F-%3E%3EAPI%3A%20POST%20%2Fapi%2Fsession%2F%3Atoken%2Fsign%0A%20%20%20%20API-%3E%3EPS%3A%20Apply%20signature%20to%20PDF%0A%20%20%20%20PS-%3E%3EFS%3A%20Read%20original%20PDF%0A%20%20%20%20FS--%3E%3EPS%3A%20PDF%20bytes%0A%20%20%20%20PS-%3E%3EPS%3A%20Embed%20signature%20image%0A%20%20%20%20PS-%3E%3EFS%3A%20Save%20signed%20PDF%20to%20signed%2F%0A%20%20%20%20FS--%3E%3EPS%3A%20Success%0A%20%20%20%20PS-%3E%3ES%3A%20Update%20session%20status%0A%20%20%20%20S-%3E%3EFS%3A%20Update%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20PS--%3E%3EAPI%3A%20Signed%20PDF%20path%0A%20%20%20%20API--%3E%3EF%3A%20%7BsignedPdfUrl%7D%0A%20%20%20%20F-%3E%3EAPI%3A%20GET%20%2Fapi%2Fadmin%2Fsession%2F%3Aid%2Fpreview-signed%0A%20%20%20%20API-%3E%3EFS%3A%20Read%20signed%20PDF%0A%20%20%20%20FS--%3E%3EAPI%3A%20PDF%20file%0A%20%20%20%20API--%3E%3EF%3A%20PDF%20stream%0A%20%20%20%20F-%3E%3EF%3A%20Display%20preview%0A%20%20%20%20%0A%20%20%20%20G-%3E%3EF%3A%20Click%20%22Confirm%22%0A%20%20%20%20F-%3E%3EAPI%3A%20POST%20%2Fapi%2Fsession%2F%3Atoken%2Fconfirm%0A%20%20%20%20API-%3E%3ES%3A%20Update%20session%20status%0A%20%20%20%20S-%3E%3EFS%3A%20Update%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20API--%3E%3EF%3A%20Success%0A%20%20%20%20F-%3E%3EAPI%3A%20GET%20%2Fapi%2Fadmin%2Fsession%2F%3Aid%2Fdownload-signed%0A%20%20%20%20API-%3E%3EFS%3A%20Read%20signed%20PDF%0A%20%20%20%20FS--%3E%3EAPI%3A%20PDF%20file%0A%20%20%20%20API--%3E%3EF%3A%20PDF%20download%0A%20%20%20%20F-%3E%3EG%3A%20Download%20PDF%0A"})]),fallback:a(()=>[...e[1]||(e[1]=[n(" Loading... ",-1)])]),_:1})),e[12]||(e[12]=r('<h3 id="flow-explanation-1" tabindex="-1">Flow Explanation <a class="header-anchor" href="#flow-explanation-1" aria-label="Permalink to &quot;Flow Explanation&quot;">​</a></h3><ol><li>Guest opens signing link</li><li>Frontend fetches session information</li><li>Frontend loads and displays PDF</li><li>Guest draws signature on canvas</li><li>Frontend exports signature as base64 PNG</li><li>Backend applies signature to PDF</li><li>Backend saves signed PDF</li><li>Frontend shows preview</li><li>Guest confirms signature</li><li>Backend marks session as completed</li><li>Frontend downloads signed PDF</li></ol><hr><h2 id="pdf-coordinate-conversion-flow" tabindex="-1">PDF Coordinate Conversion Flow <a class="header-anchor" href="#pdf-coordinate-conversion-flow" aria-label="Permalink to &quot;PDF Coordinate Conversion Flow&quot;">​</a></h2>',4)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-117",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20U%20as%20User%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20PV%20as%20PDFViewer%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20PS%20as%20PDF%20Service%0A%20%20%20%20%0A%20%20%20%20U-%3E%3EPV%3A%20Click%20on%20PDF%20canvas%0A%20%20%20%20PV-%3E%3EPV%3A%20Get%20click%20coordinates%20(canvas)%0A%20%20%20%20Note%20over%20PV%3A%20Canvas%3A%20top-left%20origin%3Cbr%2F%3EX%2C%20Y%20in%20pixels%20(scale%201.5)%0A%20%20%20%20PV-%3E%3EPV%3A%20Convert%20to%20PDF%20coordinates%0A%20%20%20%20Note%20over%20PV%3A%20PDF%3A%20bottom-left%20origin%3Cbr%2F%3EScale%3A%201.5%20%E2%86%92%201.0%0A%20%20%20%20PV-%3E%3EPV%3A%20Calculate%20pdfX%2C%20pdfY%0A%20%20%20%20PV-%3E%3EF%3A%20onPageClick(pdfX%2C%20pdfY)%0A%20%20%20%20F-%3E%3EF%3A%20Store%20coordinates%0A%20%20%20%20%0A%20%20%20%20U-%3E%3EF%3A%20Create%20session%0A%20%20%20%20F-%3E%3EAPI%3A%20POST%20%2Fapi%2Fcreate-session%0A%20%20%20%20Note%20over%20F%2CAPI%3A%20%7Bx%3A%20pdfX%2C%20y%3A%20pdfY%2C%20width%2C%20height%7D%0A%20%20%20%20API-%3E%3EPS%3A%20Apply%20signature%0A%20%20%20%20Note%20over%20PS%3A%20pdfY%20%3D%20pageHeight%20-%20y%20-%20height%3Cbr%2F%3E(Flip%20Y%20axis)%0A%20%20%20%20PS-%3E%3EPS%3A%20Draw%20signature%20at%20(pdfX%2C%20pdfY)%0A"})]),fallback:a(()=>[...e[2]||(e[2]=[n(" Loading... ",-1)])]),_:1})),e[13]||(e[13]=r(`<h3 id="coordinate-conversion-details" tabindex="-1">Coordinate Conversion Details <a class="header-anchor" href="#coordinate-conversion-details" aria-label="Permalink to &quot;Coordinate Conversion Details&quot;">​</a></h3><p><strong>Frontend (Canvas):</strong></p><ul><li>Origin: top-left (0,0)</li><li>Y increases downward</li><li>Scale: 1.5x for display</li><li>Coordinates: pixels</li></ul><p><strong>Backend (PDF):</strong></p><ul><li>Origin: bottom-left (0,0)</li><li>Y increases upward</li><li>Scale: 1.0x (actual PDF size)</li><li>Coordinates: PDF points</li></ul><p><strong>Conversion Formula:</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pdfX = canvasX / 1.5</span></span>
<span class="line"><span>pdfY = canvasY / 1.5</span></span>
<span class="line"><span>pdfY_final = pageHeight - pdfY - height</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><hr><h2 id="signature-drawing-and-export-flow" tabindex="-1">Signature Drawing and Export Flow <a class="header-anchor" href="#signature-drawing-and-export-flow" aria-label="Permalink to &quot;Signature Drawing and Export Flow&quot;">​</a></h2>`,9)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-179",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20U%20as%20User%0A%20%20%20%20participant%20SP%20as%20SignaturePad%0A%20%20%20%20participant%20C%20as%20Canvas%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20PS%20as%20PDF%20Service%0A%20%20%20%20%0A%20%20%20%20U-%3E%3ESP%3A%20Draw%20signature%0A%20%20%20%20SP-%3E%3EC%3A%20Draw%20strokes%0A%20%20%20%20C-%3E%3ESP%3A%20Update%20canvas%0A%20%20%20%20SP-%3E%3ESP%3A%20onSignatureChange%20callback%0A%20%20%20%20%0A%20%20%20%20U-%3E%3ESP%3A%20Click%20%22Apply%20Signature%22%0A%20%20%20%20SP-%3E%3EC%3A%20Export%20to%20PNG%0A%20%20%20%20Note%20over%20SP%2CC%3A%20toDataURL('image%2Fpng')%3Cbr%2F%3EGuide%20line%20NOT%20included%0A%20%20%20%20C--%3E%3ESP%3A%20base64%20PNG%20string%0A%20%20%20%20SP-%3E%3EC%3A%20Redraw%20guide%20line%20(display%20only)%0A%20%20%20%20SP-%3E%3EAPI%3A%20POST%20%2Fapi%2Fsession%2F%3Atoken%2Fsign%0A%20%20%20%20Note%20over%20SP%2CAPI%3A%20%7BsignatureImageBase64%7D%0A%20%20%20%20API-%3E%3EPS%3A%20Apply%20signature%0A%20%20%20%20PS-%3E%3EPS%3A%20Convert%20base64%20to%20Buffer%0A%20%20%20%20PS-%3E%3EPS%3A%20Embed%20PNG%20in%20PDF%0A%20%20%20%20PS-%3E%3EPS%3A%20Save%20signed%20PDF%0A%20%20%20%20PS--%3E%3EAPI%3A%20Success%0A%20%20%20%20API--%3E%3ESP%3A%20%7BsignedPdfUrl%7D%0A"})]),fallback:a(()=>[...e[3]||(e[3]=[n(" Loading... ",-1)])]),_:1})),e[14]||(e[14]=r('<h3 id="signature-export-process" tabindex="-1">Signature Export Process <a class="header-anchor" href="#signature-export-process" aria-label="Permalink to &quot;Signature Export Process&quot;">​</a></h3><ol><li>User draws on canvas</li><li>SignaturePad tracks strokes</li><li>On export, canvas converts to PNG base64</li><li>Guide line is NOT included in export</li><li>Guide line is redrawn after export (visual only)</li><li>Base64 string sent to backend</li><li>Backend converts to Buffer</li><li>Backend embeds in PDF</li></ol><hr><h2 id="session-management-flow" tabindex="-1">Session Management Flow <a class="header-anchor" href="#session-management-flow" aria-label="Permalink to &quot;Session Management Flow&quot;">​</a></h2>',4)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-229",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20A%20as%20Admin%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20A-%3E%3EF%3A%20View%20sessions%20list%0A%20%20%20%20F-%3E%3EAPI%3A%20GET%20%2Fapi%2Fadmin%2Fsessions%0A%20%20%20%20API-%3E%3ES%3A%20Get%20all%20sessions%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Sessions%20array%0A%20%20%20%20S--%3E%3EAPI%3A%20All%20sessions%0A%20%20%20%20API--%3E%3EF%3A%20Sessions%20list%0A%20%20%20%20F-%3E%3EF%3A%20Display%20table%0A%20%20%20%20%0A%20%20%20%20A-%3E%3EF%3A%20Click%20%22Copy%20URL%22%0A%20%20%20%20F-%3E%3EF%3A%20Copy%20to%20clipboard%0A%20%20%20%20%0A%20%20%20%20A-%3E%3EF%3A%20Click%20%22Download%22%0A%20%20%20%20F-%3E%3EAPI%3A%20GET%20%2Fapi%2Fadmin%2Fsession%2F%3Aid%2Fdownload-signed%0A%20%20%20%20API-%3E%3ES%3A%20Get%20session%0A%20%20%20%20S-%3E%3EFS%3A%20Read%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Session%20data%0A%20%20%20%20S--%3E%3EAPI%3A%20Session%0A%20%20%20%20API-%3E%3EFS%3A%20Read%20signed%20PDF%0A%20%20%20%20FS--%3E%3EAPI%3A%20PDF%20file%0A%20%20%20%20API--%3E%3EF%3A%20PDF%20download%0A%20%20%20%20%0A%20%20%20%20A-%3E%3EF%3A%20Click%20%22Delete%22%0A%20%20%20%20F-%3E%3EAPI%3A%20DELETE%20%2Fapi%2Fadmin%2Fsession%2F%3Aid%0A%20%20%20%20API-%3E%3ES%3A%20Delete%20session%0A%20%20%20%20S-%3E%3EFS%3A%20Delete%20signed%20PDF%0A%20%20%20%20S-%3E%3EFS%3A%20Remove%20from%20sessions.json%0A%20%20%20%20FS--%3E%3ES%3A%20Success%0A%20%20%20%20S--%3E%3EAPI%3A%20Success%0A%20%20%20%20API--%3E%3EF%3A%20Success%0A%20%20%20%20F-%3E%3EF%3A%20Refresh%20list%0A"})]),fallback:a(()=>[...e[4]||(e[4]=[n(" Loading... ",-1)])]),_:1})),e[15]||(e[15]=r('<h3 id="session-operations" tabindex="-1">Session Operations <a class="header-anchor" href="#session-operations" aria-label="Permalink to &quot;Session Operations&quot;">​</a></h3><ul><li><strong>List:</strong> Read all sessions from JSON file</li><li><strong>Copy URL:</strong> Frontend copies link to clipboard</li><li><strong>Download:</strong> Stream signed PDF file</li><li><strong>Delete:</strong> Remove session and associated files</li></ul><hr><h2 id="pdf-rendering-flow" tabindex="-1">PDF Rendering Flow <a class="header-anchor" href="#pdf-rendering-flow" aria-label="Permalink to &quot;PDF Rendering Flow&quot;">​</a></h2>',4)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-259",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20PV%20as%20PDFViewer%0A%20%20%20%20participant%20PDFJS%20as%20pdfjs-dist%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20F-%3E%3EPV%3A%20Load%20PDF%20(pdfUrl)%0A%20%20%20%20PV-%3E%3EPDFJS%3A%20getDocument(pdfUrl)%0A%20%20%20%20PDFJS-%3E%3EAPI%3A%20GET%20%2Fapi%2Fpdf%2F%3ApdfId%0A%20%20%20%20API-%3E%3EFS%3A%20Read%20PDF%20file%0A%20%20%20%20FS--%3E%3EAPI%3A%20PDF%20bytes%0A%20%20%20%20API--%3E%3EPDFJS%3A%20PDF%20stream%0A%20%20%20%20PDFJS-%3E%3EPDFJS%3A%20Parse%20PDF%0A%20%20%20%20PDFJS--%3E%3EPV%3A%20PDF%20document%0A%20%20%20%20%0A%20%20%20%20PV-%3E%3EPDFJS%3A%20getPage(pageNumber)%0A%20%20%20%20PDFJS--%3E%3EPV%3A%20Page%20object%0A%20%20%20%20PV-%3E%3EPDFJS%3A%20getViewport(%7Bscale%3A%201.5%7D)%0A%20%20%20%20PDFJS--%3E%3EPV%3A%20Viewport%0A%20%20%20%20PV-%3E%3EPV%3A%20Set%20canvas%20size%0A%20%20%20%20PV-%3E%3EPDFJS%3A%20render(renderContext)%0A%20%20%20%20PDFJS-%3E%3EPDFJS%3A%20Render%20to%20canvas%0A%20%20%20%20PDFJS--%3E%3EPV%3A%20Render%20complete%0A%20%20%20%20PV-%3E%3EF%3A%20Display%20PDF%0A"})]),fallback:a(()=>[...e[5]||(e[5]=[n(" Loading... ",-1)])]),_:1})),e[16]||(e[16]=r('<h3 id="pdf-rendering-process" tabindex="-1">PDF Rendering Process <a class="header-anchor" href="#pdf-rendering-process" aria-label="Permalink to &quot;PDF Rendering Process&quot;">​</a></h3><ol><li>Frontend requests PDF from backend</li><li>Backend streams PDF file</li><li>pdfjs-dist parses PDF document</li><li>Frontend gets specific page</li><li>Frontend creates viewport at 1.5x scale</li><li>pdfjs-dist renders page to canvas</li><li>Canvas displays PDF page</li></ol><hr><h2 id="error-handling-flow" tabindex="-1">Error Handling Flow <a class="header-anchor" href="#error-handling-flow" aria-label="Permalink to &quot;Error Handling Flow&quot;">​</a></h2>',4)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-304",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20U%20as%20User%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20S%20as%20Storage%20Service%0A%20%20%20%20participant%20FS%20as%20File%20System%0A%20%20%20%20%0A%20%20%20%20U-%3E%3EF%3A%20Action%0A%20%20%20%20F-%3E%3EAPI%3A%20Request%0A%20%20%20%20API-%3E%3ES%3A%20Service%20call%0A%20%20%20%20S-%3E%3EFS%3A%20File%20operation%0A%20%20%20%20%0A%20%20%20%20alt%20File%20Not%20Found%0A%20%20%20%20%20%20%20%20FS--%3E%3ES%3A%20Error%3A%20File%20not%20found%0A%20%20%20%20%20%20%20%20S--%3E%3EAPI%3A%20404%20Error%0A%20%20%20%20%20%20%20%20API--%3E%3EF%3A%20404%20Not%20Found%0A%20%20%20%20%20%20%20%20F-%3E%3EF%3A%20Display%20error%20message%0A%20%20%20%20else%20Invalid%20Request%0A%20%20%20%20%20%20%20%20API--%3E%3EF%3A%20400%20Bad%20Request%0A%20%20%20%20%20%20%20%20F-%3E%3EF%3A%20Display%20validation%20error%0A%20%20%20%20else%20Server%20Error%0A%20%20%20%20%20%20%20%20FS--%3E%3ES%3A%20Error%0A%20%20%20%20%20%20%20%20S--%3E%3EAPI%3A%20500%20Error%0A%20%20%20%20%20%20%20%20API--%3E%3EF%3A%20500%20Server%20Error%0A%20%20%20%20%20%20%20%20F-%3E%3EF%3A%20Display%20error%20message%0A%20%20%20%20else%20Success%0A%20%20%20%20%20%20%20%20FS--%3E%3ES%3A%20Data%0A%20%20%20%20%20%20%20%20S--%3E%3EAPI%3A%20Success%0A%20%20%20%20%20%20%20%20API--%3E%3EF%3A%20200%20OK%0A%20%20%20%20%20%20%20%20F-%3E%3EF%3A%20Update%20UI%0A%20%20%20%20end%0A"})]),fallback:a(()=>[...e[6]||(e[6]=[n(" Loading... ",-1)])]),_:1})),e[17]||(e[17]=r('<h3 id="error-handling-strategy" tabindex="-1">Error Handling Strategy <a class="header-anchor" href="#error-handling-strategy" aria-label="Permalink to &quot;Error Handling Strategy&quot;">​</a></h3><ul><li><strong>400 Bad Request:</strong> Invalid input data</li><li><strong>404 Not Found:</strong> Resource doesn&#39;t exist</li><li><strong>500 Server Error:</strong> Internal server error</li><li><strong>Success:</strong> 200 OK with data</li></ul><hr><h2 id="calibration-flow" tabindex="-1">Calibration Flow <a class="header-anchor" href="#calibration-flow" aria-label="Permalink to &quot;Calibration Flow&quot;">​</a></h2>',4)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-334",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20A%20as%20Admin%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20participant%20CP%20as%20CalibratePage%0A%20%20%20%20participant%20API%20as%20Backend%20API%0A%20%20%20%20participant%20PS%20as%20PDF%20Service%0A%20%20%20%20%0A%20%20%20%20A-%3E%3ECP%3A%20Upload%20test%20PDF%0A%20%20%20%20CP-%3E%3EAPI%3A%20POST%20%2Fapi%2Fupload-pdf%0A%20%20%20%20API--%3E%3ECP%3A%20%7BpdfId%7D%0A%20%20%20%20%0A%20%20%20%20A-%3E%3ECP%3A%20Click%20position%0A%20%20%20%20CP-%3E%3ECP%3A%20Calculate%20coordinates%0A%20%20%20%20CP-%3E%3ECP%3A%20Show%20test%20box%0A%20%20%20%20%0A%20%20%20%20A-%3E%3ECP%3A%20Adjust%20calibration%20params%0A%20%20%20%20CP-%3E%3ECP%3A%20Update%20offset%2Fscale%0A%20%20%20%20%0A%20%20%20%20A-%3E%3ECP%3A%20Click%20%22Test%22%0A%20%20%20%20CP-%3E%3EAPI%3A%20POST%20%2Fapi%2Fcalibrate%2Ftest-pdf%0A%20%20%20%20API-%3E%3EPS%3A%20Generate%20test%20PDF%0A%20%20%20%20PS-%3E%3EPS%3A%20Apply%20box%20or%20signature%0A%20%20%20%20PS--%3E%3EAPI%3A%20Test%20PDF%0A%20%20%20%20API--%3E%3ECP%3A%20PDF%20stream%0A%20%20%20%20CP-%3E%3ECP%3A%20Display%20test%20result%0A%20%20%20%20%0A%20%20%20%20A-%3E%3ECP%3A%20Verify%20placement%0A%20%20%20%20alt%20Placement%20Correct%0A%20%20%20%20%20%20%20%20A-%3E%3EA%3A%20Use%20calibration%20params%0A%20%20%20%20else%20Placement%20Incorrect%0A%20%20%20%20%20%20%20%20A-%3E%3ECP%3A%20Adjust%20params%0A%20%20%20%20%20%20%20%20CP-%3E%3ECP%3A%20Retry%20test%0A%20%20%20%20end%0A"})]),fallback:a(()=>[...e[7]||(e[7]=[n(" Loading... ",-1)])]),_:1})),e[18]||(e[18]=r('<h3 id="calibration-process" tabindex="-1">Calibration Process <a class="header-anchor" href="#calibration-process" aria-label="Permalink to &quot;Calibration Process&quot;">​</a></h3><ol><li>Upload test PDF</li><li>Click to position signature box</li><li>Adjust calibration parameters (offset, scale)</li><li>Generate test PDF with box/signature</li><li>Verify placement</li><li>Adjust if needed</li><li>Use calibrated parameters</li></ol><hr><h2 id="notes-for-developers" tabindex="-1">Notes for Developers <a class="header-anchor" href="#notes-for-developers" aria-label="Permalink to &quot;Notes for Developers&quot;">​</a></h2><h3 id="sequence-diagram-conventions" tabindex="-1">Sequence Diagram Conventions <a class="header-anchor" href="#sequence-diagram-conventions" aria-label="Permalink to &quot;Sequence Diagram Conventions&quot;">​</a></h3><ul><li><strong>Solid arrows:</strong> Synchronous operations</li><li><strong>Dashed arrows:</strong> Asynchronous operations</li><li><strong>Notes:</strong> Important implementation details</li><li><strong>Alt blocks:</strong> Conditional flows</li></ul><h3 id="key-timing-considerations" tabindex="-1">Key Timing Considerations <a class="header-anchor" href="#key-timing-considerations" aria-label="Permalink to &quot;Key Timing Considerations&quot;">​</a></h3><ul><li><strong>PDF Rendering:</strong> Can be slow for large files</li><li><strong>Signature Application:</strong> Requires PDF processing time</li><li><strong>File Operations:</strong> I/O bound operations</li><li><strong>API Calls:</strong> Network latency</li></ul><h3 id="error-scenarios" tabindex="-1">Error Scenarios <a class="header-anchor" href="#error-scenarios" aria-label="Permalink to &quot;Error Scenarios&quot;">​</a></h3><ul><li>Network failures</li><li>File system errors</li><li>Invalid PDF files</li><li>Missing sessions</li><li>Coordinate conversion errors</li></ul><hr><h2 id="notes-for-ai-regeneration" tabindex="-1">Notes for AI Regeneration <a class="header-anchor" href="#notes-for-ai-regeneration" aria-label="Permalink to &quot;Notes for AI Regeneration&quot;">​</a></h2><h3 id="required-sequence-patterns" tabindex="-1">Required Sequence Patterns <a class="header-anchor" href="#required-sequence-patterns" aria-label="Permalink to &quot;Required Sequence Patterns&quot;">​</a></h3><ol><li><strong>Upload Flow:</strong> File → Storage → Response</li><li><strong>Session Creation:</strong> Data → Validation → Storage → Token</li><li><strong>Signing Flow:</strong> Signature → PDF Processing → Storage → Preview</li><li><strong>Coordinate Conversion:</strong> Canvas → PDF coordinates → Backend</li></ol><h3 id="critical-timing" tabindex="-1">Critical Timing <a class="header-anchor" href="#critical-timing" aria-label="Permalink to &quot;Critical Timing&quot;">​</a></h3><ul><li>Always handle async operations with await</li><li>Cancel previous PDF render tasks</li><li>Clear canvas before rendering</li><li>Handle errors at each step</li></ul><h3 id="state-management" tabindex="-1">State Management <a class="header-anchor" href="#state-management" aria-label="Permalink to &quot;State Management&quot;">​</a></h3><ul><li>Frontend: React state for UI</li><li>Backend: File system for persistence</li><li>Sessions: JSON file for metadata</li><li>PDFs: File system for documents</li></ul><hr><h2 id="additional-flows" tabindex="-1">Additional Flows <a class="header-anchor" href="#additional-flows" aria-label="Permalink to &quot;Additional Flows&quot;">​</a></h2><h3 id="drag-and-resize-signature-box" tabindex="-1">Drag and Resize Signature Box <a class="header-anchor" href="#drag-and-resize-signature-box" aria-label="Permalink to &quot;Drag and Resize Signature Box&quot;">​</a></h3>',21)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-545",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20U%20as%20User%0A%20%20%20%20participant%20PV%20as%20PDFViewer%0A%20%20%20%20participant%20F%20as%20Frontend%0A%20%20%20%20%0A%20%20%20%20U-%3E%3EPV%3A%20Drag%20signature%20box%0A%20%20%20%20PV-%3E%3EPV%3A%20Calculate%20new%20position%0A%20%20%20%20PV-%3E%3EPV%3A%20Convert%20to%20PDF%20coordinates%0A%20%20%20%20PV-%3E%3EF%3A%20onPositionUpdate(newCoords)%0A%20%20%20%20F-%3E%3EF%3A%20Update%20state%0A%20%20%20%20%0A%20%20%20%20U-%3E%3EPV%3A%20Resize%20from%20corner%0A%20%20%20%20PV-%3E%3EPV%3A%20Calculate%20new%20size%0A%20%20%20%20PV-%3E%3EPV%3A%20Maintain%20aspect%20ratio%20(2%3A1)%0A%20%20%20%20PV-%3E%3EPV%3A%20Convert%20to%20PDF%20coordinates%0A%20%20%20%20PV-%3E%3EF%3A%20onPositionUpdate(newCoords)%0A%20%20%20%20F-%3E%3EF%3A%20Update%20state%0A"})]),fallback:a(()=>[...e[8]||(e[8]=[n(" Loading... ",-1)])]),_:1})),e[19]||(e[19]=A("h3",{id:"page-navigation",tabindex:"-1"},[n("Page Navigation "),A("a",{class:"header-anchor",href:"#page-navigation","aria-label":'Permalink to "Page Navigation"'},"​")],-1)),(i(),t(l,null,{default:a(()=>[o(s,{id:"mermaid-549",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20U%20as%20User%0A%20%20%20%20participant%20PV%20as%20PDFViewer%0A%20%20%20%20participant%20PDFJS%20as%20pdfjs-dist%0A%20%20%20%20%0A%20%20%20%20U-%3E%3EPV%3A%20Click%20%22Next%22%0A%20%20%20%20PV-%3E%3EPV%3A%20Increment%20page%20number%0A%20%20%20%20PV-%3E%3EPDFJS%3A%20Cancel%20previous%20render%0A%20%20%20%20PV-%3E%3EPDFJS%3A%20getPage(newPage)%0A%20%20%20%20PDFJS--%3E%3EPV%3A%20Page%20object%0A%20%20%20%20PV-%3E%3EPDFJS%3A%20Render%20page%0A%20%20%20%20PDFJS--%3E%3EPV%3A%20Render%20complete%0A%20%20%20%20PV-%3E%3EU%3A%20Display%20new%20page%0A"})]),fallback:a(()=>[...e[9]||(e[9]=[n(" Loading... ",-1)])]),_:1})),e[20]||(e[20]=r('<hr><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>These sequence diagrams document all major flows in the application. They show:</p><ul><li><strong>Data flow:</strong> How data moves through the system</li><li><strong>Component interaction:</strong> How components communicate</li><li><strong>Error handling:</strong> How errors are managed</li><li><strong>Timing:</strong> When operations occur</li></ul><p>Use these diagrams to understand the system behavior and to guide implementation.</p>',5))])}const D=d(p,[["render",F]]);export{h as __pageData,D as default};
