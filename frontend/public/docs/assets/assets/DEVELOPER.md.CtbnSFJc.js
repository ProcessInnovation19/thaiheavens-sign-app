import{_ as i,c as a,o as n,ah as e}from"./chunks/framework.D--hi4lz.js";const k=JSON.parse('{"title":"Developer Documentation","description":"","frontmatter":{},"headers":[],"relativePath":"DEVELOPER.md","filePath":"DEVELOPER.md"}'),t={name:"DEVELOPER.md"};function l(p,s,r,o,h,d){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="developer-documentation" tabindex="-1">Developer Documentation <a class="header-anchor" href="#developer-documentation" aria-label="Permalink to &quot;Developer Documentation&quot;">​</a></h1><h2 id="table-of-contents" tabindex="-1">Table of Contents <a class="header-anchor" href="#table-of-contents" aria-label="Permalink to &quot;Table of Contents&quot;">​</a></h2><ol><li><a href="#architecture-overview">Architecture Overview</a></li><li><a href="#backend-structure">Backend Structure</a></li><li><a href="#frontend-structure">Frontend Structure</a></li><li><a href="#data-models">Data Models</a></li><li><a href="#api-endpoints">API Endpoints</a></li><li><a href="#pdf-tools--coordinate-mapping">PDF Tools &amp; Coordinate Mapping</a></li><li><a href="#signature-system">Signature System</a></li><li><a href="#local-development">Local Development</a></li><li><a href="#deployment">Deployment</a></li><li><a href="#folder-structure">Folder Structure</a></li><li><a href="#extending-functionality">Extending Functionality</a></li></ol><hr><h2 id="architecture-overview" tabindex="-1">Architecture Overview <a class="header-anchor" href="#architecture-overview" aria-label="Permalink to &quot;Architecture Overview&quot;">​</a></h2><p>ThaiHeavensSignApp is a full-stack web application for managing digital signing of rental contracts (PDFs). It follows a monorepo structure with separate frontend and backend applications.</p><h3 id="technology-stack" tabindex="-1">Technology Stack <a class="header-anchor" href="#technology-stack" aria-label="Permalink to &quot;Technology Stack&quot;">​</a></h3><p><strong>Backend:</strong></p><ul><li>Node.js + TypeScript</li><li>Express.js for REST API</li><li>pdf-lib for PDF manipulation</li><li>Multer for file uploads</li><li>File system storage (JSON + files)</li></ul><p><strong>Frontend:</strong></p><ul><li>React 18 + TypeScript</li><li>Vite for build tooling</li><li>React Router for routing</li><li>pdfjs-dist for PDF rendering</li><li>signature_pad for signature drawing</li><li>Tailwind CSS for styling</li></ul><h3 id="architecture-pattern" tabindex="-1">Architecture Pattern <a class="header-anchor" href="#architecture-pattern" aria-label="Permalink to &quot;Architecture Pattern&quot;">​</a></h3><p>The application follows a <strong>client-server architecture</strong> with:</p><ul><li><strong>RESTful API</strong> backend serving JSON responses</li><li><strong>Single Page Application (SPA)</strong> frontend</li><li><strong>Stateless API</strong> design (sessions stored in JSON file)</li><li><strong>File-based storage</strong> for PDFs and session data</li></ul><hr><h2 id="backend-structure" tabindex="-1">Backend Structure <a class="header-anchor" href="#backend-structure" aria-label="Permalink to &quot;Backend Structure&quot;">​</a></h2><h3 id="project-layout" tabindex="-1">Project Layout <a class="header-anchor" href="#project-layout" aria-label="Permalink to &quot;Project Layout&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>backend/</span></span>
<span class="line"><span>├── src/</span></span>
<span class="line"><span>│   ├── index.ts              # Express app entry point</span></span>
<span class="line"><span>│   ├── models/</span></span>
<span class="line"><span>│   │   └── SigningSession.ts # TypeScript interfaces</span></span>
<span class="line"><span>│   ├── routes/</span></span>
<span class="line"><span>│   │   ├── upload.ts         # PDF upload endpoints</span></span>
<span class="line"><span>│   │   ├── session.ts        # Session management endpoints</span></span>
<span class="line"><span>│   │   ├── admin.ts          # Admin-only endpoints</span></span>
<span class="line"><span>│   │   ├── pdf.ts            # PDF streaming endpoints</span></span>
<span class="line"><span>│   │   └── calibrate.ts      # Calibration/testing endpoints</span></span>
<span class="line"><span>│   └── services/</span></span>
<span class="line"><span>│       ├── storage.ts         # File system operations</span></span>
<span class="line"><span>│       └── pdfService.ts     # PDF manipulation logic</span></span>
<span class="line"><span>├── storage/</span></span>
<span class="line"><span>│   ├── original/             # Original uploaded PDFs</span></span>
<span class="line"><span>│   ├── signed/               # Signed PDFs</span></span>
<span class="line"><span>│   └── sessions.json         # Session data (JSON)</span></span>
<span class="line"><span>├── package.json</span></span>
<span class="line"><span>└── tsconfig.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="core-services" tabindex="-1">Core Services <a class="header-anchor" href="#core-services" aria-label="Permalink to &quot;Core Services&quot;">​</a></h3><h4 id="storage-service-services-storage-ts" tabindex="-1">Storage Service (<code>services/storage.ts</code>) <a class="header-anchor" href="#storage-service-services-storage-ts" aria-label="Permalink to &quot;Storage Service (\`services/storage.ts\`)&quot;">​</a></h4><p>Manages file system operations:</p><ul><li><strong><code>initStorage()</code></strong>: Creates necessary directories on startup</li><li><strong><code>getSessions()</code></strong>: Reads all sessions from JSON file</li><li><strong><code>saveSessions()</code></strong>: Writes sessions to JSON file</li><li><strong><code>getSessionById()</code></strong>: Retrieves session by ID</li><li><strong><code>getSessionByToken()</code></strong>: Retrieves session by public token</li><li><strong><code>saveSession()</code></strong>: Saves/updates a session</li><li><strong><code>deleteSession()</code></strong>: Deletes session and associated files</li><li><strong><code>getOriginalPdfPath()</code></strong>: Returns path to original PDF</li><li><strong><code>getSignedPdfPath()</code></strong>: Returns path to signed PDF</li></ul><h4 id="pdf-service-services-pdfservice-ts" tabindex="-1">PDF Service (<code>services/pdfService.ts</code>) <a class="header-anchor" href="#pdf-service-services-pdfservice-ts" aria-label="Permalink to &quot;PDF Service (\`services/pdfService.ts\`)&quot;">​</a></h4><p>Handles PDF manipulation using pdf-lib:</p><ul><li><strong><code>applySignatureToPdf()</code></strong>: Embeds signature image into PDF at specified coordinates <ul><li>Converts canvas coordinates (top-left origin) to PDF coordinates (bottom-left origin)</li><li>Embeds PNG signature image</li><li>Saves signed PDF to disk</li></ul></li></ul><h3 id="express-app-setup" tabindex="-1">Express App Setup <a class="header-anchor" href="#express-app-setup" aria-label="Permalink to &quot;Express App Setup&quot;">​</a></h3><p>The main Express application (<code>src/index.ts</code>):</p><ol><li>Initializes storage directories</li><li>Configures CORS for frontend communication</li><li>Sets up JSON body parser (50MB limit for base64 images)</li><li>Registers route handlers: <ul><li><code>/api</code> - Upload and session routes</li><li><code>/api/admin</code> - Admin routes</li><li><code>/api/pdf</code> - PDF streaming</li><li><code>/api/calibrate</code> - Calibration routes</li></ul></li></ol><hr><h2 id="frontend-structure" tabindex="-1">Frontend Structure <a class="header-anchor" href="#frontend-structure" aria-label="Permalink to &quot;Frontend Structure&quot;">​</a></h2><h3 id="project-layout-1" tabindex="-1">Project Layout <a class="header-anchor" href="#project-layout-1" aria-label="Permalink to &quot;Project Layout&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>frontend/</span></span>
<span class="line"><span>├── src/</span></span>
<span class="line"><span>│   ├── main.tsx              # React entry point</span></span>
<span class="line"><span>│   ├── App.tsx               # Router configuration</span></span>
<span class="line"><span>│   ├── index.css             # Global styles (Tailwind)</span></span>
<span class="line"><span>│   ├── components/</span></span>
<span class="line"><span>│   │   ├── PDFViewer.tsx     # PDF rendering component</span></span>
<span class="line"><span>│   │   └── SignaturePad.tsx  # Signature drawing component</span></span>
<span class="line"><span>│   ├── pages/</span></span>
<span class="line"><span>│   │   ├── AdminPage.tsx     # Admin interface</span></span>
<span class="line"><span>│   │   ├── SignPage.tsx      # Guest signing interface</span></span>
<span class="line"><span>│   │   └── CalibratePage.tsx # Calibration tool</span></span>
<span class="line"><span>│   ├── services/</span></span>
<span class="line"><span>│   │   └── api.ts            # API client functions</span></span>
<span class="line"><span>│   └── types/</span></span>
<span class="line"><span>│       └── index.ts          # TypeScript interfaces</span></span>
<span class="line"><span>├── public/</span></span>
<span class="line"><span>├── package.json</span></span>
<span class="line"><span>├── vite.config.ts            # Vite configuration</span></span>
<span class="line"><span>└── tailwind.config.js        # Tailwind CSS configuration</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="key-components" tabindex="-1">Key Components <a class="header-anchor" href="#key-components" aria-label="Permalink to &quot;Key Components&quot;">​</a></h3><h4 id="pdfviewer-components-pdfviewer-tsx" tabindex="-1">PDFViewer (<code>components/PDFViewer.tsx</code>) <a class="header-anchor" href="#pdfviewer-components-pdfviewer-tsx" aria-label="Permalink to &quot;PDFViewer (\`components/PDFViewer.tsx\`)&quot;">​</a></h4><p>Renders PDFs using pdfjs-dist:</p><ul><li>Loads PDF from URL</li><li>Renders pages to canvas at 1.5x scale</li><li>Handles page navigation</li><li>Supports click-to-select signature position</li><li>Interactive signature box (drag &amp; resize)</li><li>Coordinate conversion (canvas ↔ PDF)</li></ul><p><strong>Props:</strong></p><ul><li><code>pdfUrl</code>: URL to PDF file</li><li><code>onPageClick</code>: Callback when user clicks on PDF</li><li><code>selectedPage</code>: Page number to display</li><li><code>selectedPosition</code>: Current signature box position</li><li><code>readOnly</code>: Disable interaction</li><li><code>onViewportReady</code>: Callback with viewport dimensions</li><li><code>onPositionUpdate</code>: Callback when position changes</li></ul><h4 id="signaturepad-components-signaturepad-tsx" tabindex="-1">SignaturePad (<code>components/SignaturePad.tsx</code>) <a class="header-anchor" href="#signaturepad-components-signaturepad-tsx" aria-label="Permalink to &quot;SignaturePad (\`components/SignaturePad.tsx\`)&quot;">​</a></h4><p>Canvas-based signature drawing using signature_pad:</p><ul><li>Transparent background</li><li>Responsive canvas sizing</li><li>Guide line at 2/3 height (visual only, not exported)</li><li>Exports as PNG with transparency</li></ul><p><strong>Props:</strong></p><ul><li><code>onSignatureChange</code>: Callback with base64 image</li><li><code>height</code>: Canvas height in pixels</li></ul><h3 id="pages" tabindex="-1">Pages <a class="header-anchor" href="#pages" aria-label="Permalink to &quot;Pages&quot;">​</a></h3><h4 id="adminpage-pages-adminpage-tsx" tabindex="-1">AdminPage (<code>pages/AdminPage.tsx</code>) <a class="header-anchor" href="#adminpage-pages-adminpage-tsx" aria-label="Permalink to &quot;AdminPage (\`pages/AdminPage.tsx\`)&quot;">​</a></h4><p>Multi-step admin interface:</p><ol><li><strong>Sessions List</strong>: View all signing sessions</li><li><strong>Upload PDF</strong>: Drag &amp; drop or file picker</li><li><strong>Select Position</strong>: Click on PDF to position signature box</li><li><strong>Create Session</strong>: Enter guest details and generate link</li></ol><p>Features:</p><ul><li>Drag &amp; drop PDF upload</li><li>Interactive signature box positioning</li><li>Box resizing and dragging</li><li>Session management (view, copy URL, delete)</li></ul><h4 id="signpage-pages-signpage-tsx" tabindex="-1">SignPage (<code>pages/SignPage.tsx</code>) <a class="header-anchor" href="#signpage-pages-signpage-tsx" aria-label="Permalink to &quot;SignPage (\`pages/SignPage.tsx\`)&quot;">​</a></h4><p>Guest signing flow:</p><ol><li><strong>View Contract</strong>: Read the PDF</li><li><strong>Draw Signature</strong>: Use canvas to sign</li><li><strong>Preview</strong>: See signed PDF preview</li><li><strong>Confirm</strong>: Finalize signature</li></ol><p>Features:</p><ul><li>Mobile-friendly interface</li><li>Touch support for signature drawing</li><li>PDF preview after signing</li><li>Download on confirmation</li></ul><h4 id="calibratepage-pages-calibratepage-tsx" tabindex="-1">CalibratePage (<code>pages/CalibratePage.tsx</code>) <a class="header-anchor" href="#calibratepage-pages-calibratepage-tsx" aria-label="Permalink to &quot;CalibratePage (\`pages/CalibratePage.tsx\`)&quot;">​</a></h4><p>Calibration tool for testing signature placement:</p><ul><li>Upload test PDF</li><li>Click to position signature box</li><li>Adjust calibration parameters (offset, scale)</li><li>Test with box or actual signature</li><li>Generate test PDF to verify placement</li></ul><h3 id="api-client-services-api-ts" tabindex="-1">API Client (<code>services/api.ts</code>) <a class="header-anchor" href="#api-client-services-api-ts" aria-label="Permalink to &quot;API Client (\`services/api.ts\`)&quot;">​</a></h3><p>Centralized API functions:</p><ul><li><code>uploadPdf(file)</code>: Upload PDF file</li><li><code>createSession(data)</code>: Create signing session</li><li><code>getSessionByToken(token)</code>: Get session info</li><li><code>signSession(token, signatureBase64)</code>: Apply signature</li><li><code>confirmSession(token)</code>: Confirm signature</li><li><code>getAllSessions()</code>: Get all sessions (admin)</li><li><code>downloadSignedPdf(sessionId)</code>: Download signed PDF</li><li><code>deleteSession(sessionId)</code>: Delete session</li></ul><hr><h2 id="data-models" tabindex="-1">Data Models <a class="header-anchor" href="#data-models" aria-label="Permalink to &quot;Data Models&quot;">​</a></h2><h3 id="signingsession" tabindex="-1">SigningSession <a class="header-anchor" href="#signingsession" aria-label="Permalink to &quot;SigningSession&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SigningSession</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// UUID</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Public token (no dashes)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  pdfId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// UUID of original PDF</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  originalPdfPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// File system path</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  signedPdfPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// File system path (after signing)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  guestName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Optional guest name</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  guestEmail</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Optional guest email</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  page</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// PDF page index (0-based)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// X coordinate (PDF points)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Y coordinate (PDF points)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  width</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Signature width (PDF points)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  height</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Signature height (PDF points)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pending&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;signed&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;completed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  createdAt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ISO timestamp</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  updatedAt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ISO timestamp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="sessionpublicinfo" tabindex="-1">SessionPublicInfo <a class="header-anchor" href="#sessionpublicinfo" aria-label="Permalink to &quot;SessionPublicInfo&quot;">​</a></h3><p>Public-facing session data (no internal paths):</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SessionPublicInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  guestName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  guestEmail</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pending&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;signed&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;completed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  pdfViewUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Public URL to view PDF</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  page</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr><h2 id="api-endpoints" tabindex="-1">API Endpoints <a class="header-anchor" href="#api-endpoints" aria-label="Permalink to &quot;API Endpoints&quot;">​</a></h2><h3 id="upload-endpoints" tabindex="-1">Upload Endpoints <a class="header-anchor" href="#upload-endpoints" aria-label="Permalink to &quot;Upload Endpoints&quot;">​</a></h3><h4 id="post-api-upload-pdf" tabindex="-1"><code>POST /api/upload-pdf</code> <a class="header-anchor" href="#post-api-upload-pdf" aria-label="Permalink to &quot;\`POST /api/upload-pdf\`&quot;">​</a></h4><p>Upload a PDF file.</p><p><strong>Request:</strong></p><ul><li>Content-Type: <code>multipart/form-data</code></li><li>Body: <code>file</code> (PDF file)</li></ul><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;filePath&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/path/to/file.pdf&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="session-endpoints" tabindex="-1">Session Endpoints <a class="header-anchor" href="#session-endpoints" aria-label="Permalink to &quot;Session Endpoints&quot;">​</a></h3><h4 id="post-api-create-session" tabindex="-1"><code>POST /api/create-session</code> <a class="header-anchor" href="#post-api-create-session" aria-label="Permalink to &quot;\`POST /api/create-session\`&quot;">​</a></h4><p>Create a new signing session.</p><p><strong>Request:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestEmail&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;john@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;page&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sessionId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tokenstring&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;publicUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/sign/tokenstring&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="get-api-session-token" tabindex="-1"><code>GET /api/session/:token</code> <a class="header-anchor" href="#get-api-session-token" aria-label="Permalink to &quot;\`GET /api/session/:token\`&quot;">​</a></h4><p>Get session information (public endpoint).</p><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tokenstring&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;guestEmail&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;john@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pending&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfViewUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/pdf/uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;page&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="post-api-session-token-sign" tabindex="-1"><code>POST /api/session/:token/sign</code> <a class="header-anchor" href="#post-api-session-token-sign" aria-label="Permalink to &quot;\`POST /api/session/:token/sign\`&quot;">​</a></h4><p>Apply signature to PDF.</p><p><strong>Request:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;signatureImageBase64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;data:image/png;base64,...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;signedPdfUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/admin/session/:id/preview-signed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sessionId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="post-api-session-token-confirm" tabindex="-1"><code>POST /api/session/:token/confirm</code> <a class="header-anchor" href="#post-api-session-token-confirm" aria-label="Permalink to &quot;\`POST /api/session/:token/confirm\`&quot;">​</a></h4><p>Confirm signature and mark session as completed.</p><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="admin-endpoints" tabindex="-1">Admin Endpoints <a class="header-anchor" href="#admin-endpoints" aria-label="Permalink to &quot;Admin Endpoints&quot;">​</a></h3><h4 id="get-api-admin-sessions" tabindex="-1"><code>GET /api/admin/sessions</code> <a class="header-anchor" href="#get-api-admin-sessions" aria-label="Permalink to &quot;\`GET /api/admin/sessions\`&quot;">​</a></h4><p>Get all sessions (admin only).</p><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tokenstring&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;guestName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;completed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="get-api-admin-session-id-download-signed" tabindex="-1"><code>GET /api/admin/session/:id/download-signed</code> <a class="header-anchor" href="#get-api-admin-session-id-download-signed" aria-label="Permalink to &quot;\`GET /api/admin/session/:id/download-signed\`&quot;">​</a></h4><p>Download signed PDF.</p><p><strong>Response:</strong> PDF file stream</p><h4 id="get-api-admin-session-id-preview-signed" tabindex="-1"><code>GET /api/admin/session/:id/preview-signed</code> <a class="header-anchor" href="#get-api-admin-session-id-preview-signed" aria-label="Permalink to &quot;\`GET /api/admin/session/:id/preview-signed\`&quot;">​</a></h4><p>Preview signed PDF (inline).</p><p><strong>Response:</strong> PDF file stream with inline content-type</p><h4 id="delete-api-admin-session-id" tabindex="-1"><code>DELETE /api/admin/session/:id</code> <a class="header-anchor" href="#delete-api-admin-session-id" aria-label="Permalink to &quot;\`DELETE /api/admin/session/:id\`&quot;">​</a></h4><p>Delete session and associated files.</p><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="pdf-endpoints" tabindex="-1">PDF Endpoints <a class="header-anchor" href="#pdf-endpoints" aria-label="Permalink to &quot;PDF Endpoints&quot;">​</a></h3><h4 id="get-api-pdf-pdfid" tabindex="-1"><code>GET /api/pdf/:pdfId</code> <a class="header-anchor" href="#get-api-pdf-pdfid" aria-label="Permalink to &quot;\`GET /api/pdf/:pdfId\`&quot;">​</a></h4><p>Stream original PDF file.</p><p><strong>Response:</strong> PDF file stream</p><h3 id="calibration-endpoints" tabindex="-1">Calibration Endpoints <a class="header-anchor" href="#calibration-endpoints" aria-label="Permalink to &quot;Calibration Endpoints&quot;">​</a></h3><h4 id="post-api-calibrate-test-pdf" tabindex="-1"><code>POST /api/calibrate/test-pdf</code> <a class="header-anchor" href="#post-api-calibrate-test-pdf" aria-label="Permalink to &quot;\`POST /api/calibrate/test-pdf\`&quot;">​</a></h4><p>Generate test PDF with signature box or signature.</p><p><strong>Request:</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pdfId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;page&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;signatureImageBase64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;optional&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Response:</strong> PDF file stream</p><hr><h2 id="pdf-tools-coordinate-mapping" tabindex="-1">PDF Tools &amp; Coordinate Mapping <a class="header-anchor" href="#pdf-tools-coordinate-mapping" aria-label="Permalink to &quot;PDF Tools &amp; Coordinate Mapping&quot;">​</a></h2><h3 id="coordinate-systems" tabindex="-1">Coordinate Systems <a class="header-anchor" href="#coordinate-systems" aria-label="Permalink to &quot;Coordinate Systems&quot;">​</a></h3><p>The application uses two coordinate systems:</p><ol><li><p><strong>Canvas Coordinates</strong> (top-left origin):</p><ul><li>Used in frontend for display</li><li>Origin (0,0) at top-left corner</li><li>Y increases downward</li></ul></li><li><p><strong>PDF Coordinates</strong> (bottom-left origin):</p><ul><li>Used in backend for PDF manipulation</li><li>Origin (0,0) at bottom-left corner</li><li>Y increases upward</li></ul></li></ol><h3 id="conversion-logic" tabindex="-1">Conversion Logic <a class="header-anchor" href="#conversion-logic" aria-label="Permalink to &quot;Conversion Logic&quot;">​</a></h3><p><strong>Frontend → Backend:</strong></p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Canvas is rendered at scale 1.5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pdfScaleRatio</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> displayViewport.scale; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1/1.5 = 0.666...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pdfX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canvasX </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdfScaleRatio;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pdfY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canvasY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdfScaleRatio;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Backend PDF Placement:</strong></p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// PDF coordinates have bottom-left origin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pdfX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> session.x; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// X stays the same</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pdfY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pageHeight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> session.y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> session.height; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Flip Y</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="pdf-rendering" tabindex="-1">PDF Rendering <a class="header-anchor" href="#pdf-rendering" aria-label="Permalink to &quot;PDF Rendering&quot;">​</a></h3><p><strong>Frontend (pdfjs-dist):</strong></p><ul><li>Renders PDF pages to HTML5 canvas</li><li>Uses viewport scale of 1.5 for better quality</li><li>Handles page navigation</li><li>Supports touch events for mobile</li></ul><p><strong>Backend (pdf-lib):</strong></p><ul><li>Loads PDF from file system</li><li>Embeds PNG signature image</li><li>Draws image at calculated coordinates</li><li>Saves modified PDF to disk</li></ul><h3 id="signature-box-positioning" tabindex="-1">Signature Box Positioning <a class="header-anchor" href="#signature-box-positioning" aria-label="Permalink to &quot;Signature Box Positioning&quot;">​</a></h3><p>The signature box is rendered as an HTML overlay on the canvas:</p><ul><li>Default size: 200x100px (2:1 aspect ratio)</li><li>Draggable for repositioning</li><li>Resizable from corners (maintains aspect ratio)</li><li>Guide line at 2/3 height (visual only)</li><li>Coordinates updated in real-time</li></ul><hr><h2 id="signature-system" tabindex="-1">Signature System <a class="header-anchor" href="#signature-system" aria-label="Permalink to &quot;Signature System&quot;">​</a></h2><h3 id="signature-drawing" tabindex="-1">Signature Drawing <a class="header-anchor" href="#signature-drawing" aria-label="Permalink to &quot;Signature Drawing&quot;">​</a></h3><p><strong>Library:</strong> signature_pad v4.0.9</p><p><strong>Features:</strong></p><ul><li>Transparent background (RGBA)</li><li>Smooth stroke rendering</li><li>Touch and mouse support</li><li>Responsive canvas sizing</li><li>Export as PNG with transparency</li></ul><h3 id="signature-export" tabindex="-1">Signature Export <a class="header-anchor" href="#signature-export" aria-label="Permalink to &quot;Signature Export&quot;">​</a></h3><p><strong>Process:</strong></p><ol><li>User draws signature on canvas</li><li>Signature is exported as base64 PNG</li><li>Guide line is NOT included in export (redrawn after export)</li><li>Base64 string sent to backend</li><li>Backend converts to Buffer and embeds in PDF</li></ol><h3 id="signature-placement" tabindex="-1">Signature Placement <a class="header-anchor" href="#signature-placement" aria-label="Permalink to &quot;Signature Placement&quot;">​</a></h3><p><strong>Visual Guide:</strong></p><ul><li>Horizontal line at 2/3 height from top</li><li>Helps user align signature vertically</li><li>Only visible on screen, not in exported image</li></ul><p><strong>PDF Embedding:</strong></p><ul><li>Signature image embedded at exact coordinates</li><li>Maintains original size and aspect ratio</li><li>Transparent background preserved</li></ul><hr><h2 id="local-development" tabindex="-1">Local Development <a class="header-anchor" href="#local-development" aria-label="Permalink to &quot;Local Development&quot;">​</a></h2><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h3><ul><li>Node.js 18+ and npm</li><li>TypeScript knowledge</li><li>Modern browser</li></ul><h3 id="setup" tabindex="-1">Setup <a class="header-anchor" href="#setup" aria-label="Permalink to &quot;Setup&quot;">​</a></h3><ol><li><p><strong>Clone repository</strong> (if applicable)</p></li><li><p><strong>Install backend dependencies:</strong></p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><strong>Install frontend dependencies:</strong></p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frontend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol><h3 id="running-development-servers" tabindex="-1">Running Development Servers <a class="header-anchor" href="#running-development-servers" aria-label="Permalink to &quot;Running Development Servers&quot;">​</a></h3><p><strong>Option 1: Manual (separate terminals)</strong></p><p>Terminal 1 - Backend:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Backend runs on <code>http://localhost:5000</code></p><p>Terminal 2 - Frontend:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frontend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Frontend runs on <code>http://localhost:5173</code></p><p><strong>Option 2: PowerShell Script (Windows)</strong></p><p>Run the provided script:</p><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\start-servers.ps1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>This opens two separate windows for backend and frontend.</p><h3 id="development-urls" tabindex="-1">Development URLs <a class="header-anchor" href="#development-urls" aria-label="Permalink to &quot;Development URLs&quot;">​</a></h3><ul><li><strong>Admin Interface:</strong> <a href="http://localhost:5173/admin" target="_blank" rel="noreferrer">http://localhost:5173/admin</a></li><li><strong>Guest Signing:</strong> <a href="http://localhost:5173/sign/:token" target="_blank" rel="noreferrer">http://localhost:5173/sign/:token</a></li><li><strong>Calibration Tool:</strong> <a href="http://localhost:5173/calibrate" target="_blank" rel="noreferrer">http://localhost:5173/calibrate</a></li><li><strong>Backend API:</strong> <a href="http://localhost:5000/api" target="_blank" rel="noreferrer">http://localhost:5000/api</a></li><li><strong>Documentation:</strong> <a href="http://localhost:5173/docs" target="_blank" rel="noreferrer">http://localhost:5173/docs</a></li></ul><h3 id="hot-reload" tabindex="-1">Hot Reload <a class="header-anchor" href="#hot-reload" aria-label="Permalink to &quot;Hot Reload&quot;">​</a></h3><p>Both servers support hot reload:</p><ul><li><strong>Backend:</strong> Uses <code>ts-node-dev</code> with <code>--respawn</code> flag</li><li><strong>Frontend:</strong> Uses Vite HMR (Hot Module Replacement)</li></ul><h3 id="storage-directories" tabindex="-1">Storage Directories <a class="header-anchor" href="#storage-directories" aria-label="Permalink to &quot;Storage Directories&quot;">​</a></h3><p>On first run, the backend creates:</p><ul><li><code>backend/storage/original/</code> - Original PDFs</li><li><code>backend/storage/signed/</code> - Signed PDFs</li><li><code>backend/storage/sessions.json</code> - Session data</li></ul><hr><h2 id="deployment" tabindex="-1">Deployment <a class="header-anchor" href="#deployment" aria-label="Permalink to &quot;Deployment&quot;">​</a></h2><h3 id="production-build" tabindex="-1">Production Build <a class="header-anchor" href="#production-build" aria-label="Permalink to &quot;Production Build&quot;">​</a></h3><p><strong>Backend:</strong></p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Frontend:</strong></p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frontend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Output: <code>frontend/dist/</code></p><h3 id="environment-variables" tabindex="-1">Environment Variables <a class="header-anchor" href="#environment-variables" aria-label="Permalink to &quot;Environment Variables&quot;">​</a></h3><p><strong>Backend:</strong></p><ul><li><code>PORT</code> - Server port (default: 5000)</li></ul><p><strong>Frontend:</strong></p><ul><li>Configured in <code>vite.config.ts</code></li><li>API proxy: <code>/api</code> → <code>http://localhost:5000</code></li></ul><h3 id="deployment-options" tabindex="-1">Deployment Options <a class="header-anchor" href="#deployment-options" aria-label="Permalink to &quot;Deployment Options&quot;">​</a></h3><p><strong>Option 1: Traditional Hosting</strong></p><ul><li>Deploy backend to Node.js hosting (Heroku, Railway, etc.)</li><li>Deploy frontend to static hosting (Vercel, Netlify, etc.)</li><li>Update frontend API base URL</li></ul><p><strong>Option 2: Single Server</strong></p><ul><li>Serve frontend build from Express</li><li>Add static file serving in <code>backend/src/index.ts</code>:<div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(express.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;../../frontend/dist&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)));</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ul><p><strong>Option 3: Docker</strong></p><ul><li>Create Dockerfile for backend</li><li>Use nginx for frontend</li><li>Set up reverse proxy</li></ul><h3 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h3><p><strong>Current State:</strong></p><ul><li>No authentication (admin routes are public)</li><li>No rate limiting</li><li>File uploads not validated (should add PDF validation)</li><li>CORS allows all origins</li></ul><p><strong>Recommended for Production:</strong></p><ul><li>Add authentication middleware</li><li>Implement rate limiting</li><li>Validate file types and sizes</li><li>Restrict CORS to specific origins</li><li>Use environment variables for secrets</li><li>Add HTTPS/SSL</li></ul><hr><h2 id="folder-structure" tabindex="-1">Folder Structure <a class="header-anchor" href="#folder-structure" aria-label="Permalink to &quot;Folder Structure&quot;">​</a></h2><h3 id="root-structure" tabindex="-1">Root Structure <a class="header-anchor" href="#root-structure" aria-label="Permalink to &quot;Root Structure&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ThaiHeavensSignApp/</span></span>
<span class="line"><span>├── backend/              # Backend application</span></span>
<span class="line"><span>├── frontend/             # Frontend application</span></span>
<span class="line"><span>├── docs/                 # Documentation markdown files</span></span>
<span class="line"><span>├── docs-site/            # VitePress documentation site</span></span>
<span class="line"><span>├── README.md             # Project overview</span></span>
<span class="line"><span>├── start-servers.ps1     # Development script (Windows)</span></span>
<span class="line"><span>└── cursor-rules.txt      # Project rules</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="backend-structure-1" tabindex="-1">Backend Structure <a class="header-anchor" href="#backend-structure-1" aria-label="Permalink to &quot;Backend Structure&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>backend/</span></span>
<span class="line"><span>├── src/</span></span>
<span class="line"><span>│   ├── index.ts          # Express app entry</span></span>
<span class="line"><span>│   ├── models/           # TypeScript interfaces</span></span>
<span class="line"><span>│   ├── routes/           # API route handlers</span></span>
<span class="line"><span>│   └── services/         # Business logic</span></span>
<span class="line"><span>├── storage/              # File storage</span></span>
<span class="line"><span>│   ├── original/         # Original PDFs</span></span>
<span class="line"><span>│   ├── signed/           # Signed PDFs</span></span>
<span class="line"><span>│   └── sessions.json     # Session data</span></span>
<span class="line"><span>├── uploads/              # Temporary uploads (Multer)</span></span>
<span class="line"><span>├── package.json</span></span>
<span class="line"><span>└── tsconfig.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="frontend-structure-1" tabindex="-1">Frontend Structure <a class="header-anchor" href="#frontend-structure-1" aria-label="Permalink to &quot;Frontend Structure&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>frontend/</span></span>
<span class="line"><span>├── src/</span></span>
<span class="line"><span>│   ├── main.tsx          # React entry</span></span>
<span class="line"><span>│   ├── App.tsx           # Router</span></span>
<span class="line"><span>│   ├── components/       # Reusable components</span></span>
<span class="line"><span>│   ├── pages/            # Page components</span></span>
<span class="line"><span>│   ├── services/         # API client</span></span>
<span class="line"><span>│   └── types/            # TypeScript types</span></span>
<span class="line"><span>├── public/               # Static assets</span></span>
<span class="line"><span>├── dist/                 # Build output</span></span>
<span class="line"><span>├── package.json</span></span>
<span class="line"><span>├── vite.config.ts</span></span>
<span class="line"><span>└── tailwind.config.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr><h2 id="extending-functionality" tabindex="-1">Extending Functionality <a class="header-anchor" href="#extending-functionality" aria-label="Permalink to &quot;Extending Functionality&quot;">​</a></h2><h3 id="adding-new-api-endpoints" tabindex="-1">Adding New API Endpoints <a class="header-anchor" href="#adding-new-api-endpoints" aria-label="Permalink to &quot;Adding New API Endpoints&quot;">​</a></h3><ol><li>Create route file in <code>backend/src/routes/</code></li><li>Export router: <code>export const myRoutes = Router();</code></li><li>Define endpoints: <code>myRoutes.get(&#39;/path&#39;, handler)</code></li><li>Register in <code>backend/src/index.ts</code>: <code>app.use(&#39;/api&#39;, myRoutes)</code></li></ol><h3 id="adding-new-frontend-pages" tabindex="-1">Adding New Frontend Pages <a class="header-anchor" href="#adding-new-frontend-pages" aria-label="Permalink to &quot;Adding New Frontend Pages&quot;">​</a></h3><ol><li>Create component in <code>frontend/src/pages/</code></li><li>Add route in <code>frontend/src/App.tsx</code>:<div class="language-tsx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Route</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/my-page&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MyPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;} /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ol><h3 id="adding-authentication" tabindex="-1">Adding Authentication <a class="header-anchor" href="#adding-authentication" aria-label="Permalink to &quot;Adding Authentication&quot;">​</a></h3><p><strong>Backend:</strong></p><ol><li>Install auth library (e.g., <code>jsonwebtoken</code>)</li><li>Create middleware: <code>middleware/auth.ts</code></li><li>Protect routes: <code>adminRoutes.use(authMiddleware)</code></li></ol><p><strong>Frontend:</strong></p><ol><li>Add login page</li><li>Store token in localStorage</li><li>Add to API requests: <code>Authorization: Bearer \${token}</code></li></ol><h3 id="adding-database" tabindex="-1">Adding Database <a class="header-anchor" href="#adding-database" aria-label="Permalink to &quot;Adding Database&quot;">​</a></h3><p>Replace JSON file storage:</p><ol><li>Install database (e.g., PostgreSQL, MongoDB)</li><li>Create models/ORM setup</li><li>Update <code>services/storage.ts</code> to use database</li><li>Migrate existing sessions</li></ol><h3 id="adding-email-notifications" tabindex="-1">Adding Email Notifications <a class="header-anchor" href="#adding-email-notifications" aria-label="Permalink to &quot;Adding Email Notifications&quot;">​</a></h3><ol><li>Install email library (e.g., <code>nodemailer</code>)</li><li>Create service: <code>services/email.ts</code></li><li>Send email on session creation/confirmation</li><li>Use environment variables for SMTP config</li></ol><h3 id="adding-multi-signature-support" tabindex="-1">Adding Multi-Signature Support <a class="header-anchor" href="#adding-multi-signature-support" aria-label="Permalink to &quot;Adding Multi-Signature Support&quot;">​</a></h3><ol><li>Extend <code>SigningSession</code> model:<div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">signatures</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;{</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  width</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  height</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  page</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li><li>Update PDF service to handle multiple signatures</li><li>Update frontend to support multiple boxes</li></ol><h3 id="adding-pdf-templates" tabindex="-1">Adding PDF Templates <a class="header-anchor" href="#adding-pdf-templates" aria-label="Permalink to &quot;Adding PDF Templates&quot;">​</a></h3><ol><li>Create template system in <code>services/pdfService.ts</code></li><li>Support template variables</li><li>Add template selection in admin interface</li></ol><hr><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="common-issues" tabindex="-1">Common Issues <a class="header-anchor" href="#common-issues" aria-label="Permalink to &quot;Common Issues&quot;">​</a></h3><p><strong>Backend won&#39;t start:</strong></p><ul><li>Check if port 5000 is available</li><li>Verify <code>storage/</code> directories exist</li><li>Check TypeScript compilation errors</li></ul><p><strong>Frontend can&#39;t connect to backend:</strong></p><ul><li>Verify backend is running</li><li>Check CORS configuration</li><li>Verify proxy settings in <code>vite.config.ts</code></li></ul><p><strong>PDF not rendering:</strong></p><ul><li>Check browser console for errors</li><li>Verify PDF file is valid</li><li>Check pdfjs-dist worker URL</li></ul><p><strong>Signature not appearing:</strong></p><ul><li>Verify coordinate conversion</li><li>Check PDF coordinate system (bottom-left origin)</li><li>Verify signature image is valid PNG</li></ul><p><strong>Storage issues:</strong></p><ul><li>Check file permissions</li><li>Verify storage directories exist</li><li>Check disk space</li></ul><hr><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><ol><li><strong>Type Safety:</strong> Always use TypeScript interfaces</li><li><strong>Error Handling:</strong> Wrap async operations in try-catch</li><li><strong>Validation:</strong> Validate user inputs on both frontend and backend</li><li><strong>Comments:</strong> Document coordinate conversions and complex logic</li><li><strong>Testing:</strong> Add unit tests for services and utilities</li><li><strong>Code Organization:</strong> Keep routes thin, move logic to services</li><li><strong>Security:</strong> Never expose internal file paths to frontend</li><li><strong>Performance:</strong> Optimize PDF rendering and image sizes</li></ol><hr><h2 id="additional-resources" tabindex="-1">Additional Resources <a class="header-anchor" href="#additional-resources" aria-label="Permalink to &quot;Additional Resources&quot;">​</a></h2><ul><li><a href="https://pdf-lib.js.org/" target="_blank" rel="noreferrer">pdf-lib Documentation</a></li><li><a href="https://mozilla.github.io/pdf.js/" target="_blank" rel="noreferrer">pdfjs-dist Documentation</a></li><li><a href="https://github.com/szimek/signature_pad" target="_blank" rel="noreferrer">signature_pad Documentation</a></li><li><a href="https://expressjs.com/" target="_blank" rel="noreferrer">Express.js Documentation</a></li><li><a href="https://react.dev/" target="_blank" rel="noreferrer">React Documentation</a></li><li><a href="https://vitejs.dev/" target="_blank" rel="noreferrer">Vite Documentation</a></li><li><a href="https://vitepress.dev/" target="_blank" rel="noreferrer">VitePress Documentation</a></li></ul>`,252)])])}const g=i(t,[["render",l]]);export{k as __pageData,g as default};
